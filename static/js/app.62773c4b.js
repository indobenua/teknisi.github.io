(function(t){function e(e){for(var a,i,o=e[0],c=e[1],l=e[2],p=0,d=[];p<o.length;p++)i=o[p],Object.prototype.hasOwnProperty.call(n,i)&&n[i]&&d.push(n[i][0]),n[i]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(t[a]=c[a]);u&&u(e);while(d.length)d.shift()();return s.push.apply(s,l||[]),r()}function r(){for(var t,e=0;e<s.length;e++){for(var r=s[e],a=!0,o=1;o<r.length;o++){var c=r[o];0!==n[c]&&(a=!1)}a&&(s.splice(e--,1),t=i(i.s=r[0]))}return t}var a={},n={app:0},s=[];function i(e){if(a[e])return a[e].exports;var r=a[e]={i:e,l:!1,exports:{}};return t[e].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=t,i.c=a,i.d=function(t,e,r){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)i.d(r,a,function(e){return t[e]}.bind(null,a));return r},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],c=o.push.bind(o);o.push=e,o=o.slice();for(var l=0;l<o.length;l++)e(o[l]);var u=c;s.push([0,"chunk-vendors"]),r()})({0:function(t,e,r){t.exports=r("56d7")},"0408":function(t,e,r){},1487:function(t,e,r){"use strict";r("18c6")},"14c9":function(t,e,r){"use strict";r("d4e4")},"18c6":function(t,e,r){},3109:function(t,e,r){"use strict";r("912d")},"3b1f":function(t,e,r){},"3bf6":function(t,e,r){},"43d4":function(t,e,r){},5358:function(t,e,r){},"56d7":function(t,e,r){"use strict";r.r(e);r("cadf"),r("551c"),r("f751"),r("097d");var a=r("ba4c"),n=r.n(a),s=r("660e");n.a.use(s["a"],{breakpoints:{mobile:450,tablet:900,laptop:1250,desktop:1/0}});var i=r("8c4f");n.a.use(i["a"]);var o=r("bb71");r("da64");n.a.use(o["a"],{theme:{primary:"#ea80fc",secondary:"#424242",accent:"#82B1FF",error:"#FF5252",info:"#2196F3",success:"#4CAF50",warning:"#FFC107"},iconfont:"md"});var c=r("b079"),l=r.n(c);r("4238");n.a.use(l.a,{position:"top"});var u=r("8cb8"),p=function(){var t=this,e=t._self._c;return e("div",{staticClass:"login-container"},[e("div",{staticClass:"login-form"},[e("h1",[t._v("INDOBENUA")]),t.loading?e("div",[e("i",{staticClass:"fa fa-spinner fa-spin"})]):e("form",{on:{submit:function(e){return e.preventDefault(),t.login.apply(null,arguments)}}},[e("div",{staticClass:"input-group"},[e("label",{attrs:{for:"username"}},[t._v("Username")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.username,expression:"username"}],attrs:{type:"text",id:"username",required:"",autocomplete:"off"},domProps:{value:t.username},on:{input:function(e){e.target.composing||(t.username=e.target.value)}}}),t.errors.username?e("span",{staticClass:"error-message"},[t._v(t._s(t.errors.username[0]))]):t._e()]),e("div",{staticClass:"input-group"},[e("label",{attrs:{for:"password"}},[t._v("Password")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.password,expression:"password"}],attrs:{type:"password",id:"password",required:"",autocomplete:"off"},domProps:{value:t.password},on:{input:function(e){e.target.composing||(t.password=e.target.value)}}}),t.errors.password?e("span",{staticClass:"error-message"},[t._v(t._s(t.errors.password[0]))]):t._e()]),e("button",{staticClass:"submit-button",attrs:{type:"submit"}},[t._v("Login")])]),t.errors.general?e("span",{staticClass:"error-message"},[t._v(t._s(t.errors.general))]):t._e()])])},d=[],f=(r("96cf"),r("1da1")),m=(r("7f7f"),r("faac")),v=r.n(m),h=(r("a481"),r("cee4")),g=r("2f62");n.a.use(g["a"]);var b=new g["a"].Store({state:{user:null,isLoading:!1,statistic:{}},mutations:{setUser:function(t,e){t.user=e},setLoading:function(t,e){t.isLoading=e},setStatistic:function(t,e){t.statistic=e}},actions:{fetchUser:function(){var t=Object(f["a"])(regeneratorRuntime.mark((function t(e){var r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=e.commit,t.prev=1,t.next=4,F.get("/user");case 4:a=t.sent,r("setUser",a.data),t.next=11;break;case 8:t.prev=8,t.t0=t["catch"](1),console.error("Failed to fetch user data:",t.t0);case 11:case"end":return t.stop()}}),t,null,[[1,8]])})));function e(e){return t.apply(this,arguments)}return e}(),setLoading:function(t,e){var r=t.commit;r("setLoading",e)},setStatistic:function(){var t=Object(f["a"])(regeneratorRuntime.mark((function t(e){var r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=e.commit,t.prev=1,t.next=4,F.get("/statistic");case 4:a=t.sent,r("setStatistic",a.data),t.next=10;break;case 8:t.prev=8,t.t0=t["catch"](1);case 10:case"end":return t.stop()}}),t,null,[[1,8]])})));function e(e){return t.apply(this,arguments)}return e}()}}),k=(r("ac6a"),"myAppDB"),_=1,w="tasks",C="serviceCalls";function O(){return new Promise((function(t,e){var r=indexedDB.open(k,_);r.onupgradeneeded=function(t){var e=t.target.result;e.objectStoreNames.contains(w)||e.createObjectStore(w,{keyPath:"id"}),e.objectStoreNames.contains(C)||e.createObjectStore(C,{keyPath:"id"})},r.onsuccess=function(e){t(e.target.result)},r.onerror=function(t){e(t.target.error)}}))}function y(t,e){return O().then((function(r){return new Promise((function(a,n){var s=r.transaction([t],"readwrite"),i=s.objectStore(t);e.forEach((function(t){i.put(t)})),s.oncomplete=function(){a()},s.onerror=function(t){n(t.target.error)}}))}))}function j(t){return O().then((function(e){return new Promise((function(r,a){var n=e.transaction([t],"readonly"),s=n.objectStore(t),i=s.getAll();i.onsuccess=function(t){r(t.target.result)},i.onerror=function(t){a(t.target.error)}}))}))}function x(t){return O().then((function(e){return new Promise((function(r,a){var n=e.transaction([t],"readwrite"),s=n.objectStore(t),i=s.clear();i.onsuccess=function(){r()},i.onerror=function(t){a(t.target.error)}}))}))}function P(t,e,r,a){return D.apply(this,arguments)}function D(){return D=Object(f["a"])(regeneratorRuntime.mark((function t(e,r,a,n){var s,i,o,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,O();case 2:return s=t.sent,i=s.transaction(e,"readwrite"),o=i.objectStore(e),c=o.get(r),c.onsuccess=function(){var t=c.result;if(t){switch(n){case"comments":t.task.comments=a;break;case"note":t.note=a;break;case"sc":t.status=a.status,t.lines=a.lines;break}o.put(t)}},t.abrupt("return",new Promise((function(t,e){i.oncomplete=t,i.onerror=e})));case 8:case"end":return t.stop()}}),t)}))),D.apply(this,arguments)}function S(){return new Promise((function(t,e){var r=indexedDB.deleteDatabase(k);r.onsuccess=function(){console.log("Database deleted successfully"),t()},r.onerror=function(t){console.error("Error deleting database:",t),e(t)},r.onblocked=function(){console.warn("Database deletion blocked"),e(new Error("Database deletion blocked"))}}))}var T=h["a"].create({baseURL:"https://ac.igm.biz.id/api",headers:{"Content-Type":"application/json"}});T.interceptors.request.use((function(t){var e=localStorage.getItem("api_token");return e&&(t.headers["Authorization"]="Bearer ".concat(e)),b.dispatch("setLoading",!0),t}),(function(t){return b.dispatch("setLoading",!1),Promise.reject(t)})),T.interceptors.response.use((function(t){return b.dispatch("setLoading",!1),t}),(function(t){return t&&t.response&&t.response.status&&401===t.response.status&&(console.log("User tidak autentik"),localStorage.clear(),S(),"/login"!==location.pathname&&location.replace("/login")),b.dispatch("setLoading",!1),Promise.reject(t)}));var F=T,R={data:function(){return{username:"",password:"",deviceName:"",errors:{},loading:!1}},mounted:function(){this.deviceName=v.a.name+" "+v.a.version},methods:{login:function(){var t=Object(f["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.errors={},this.loading=!0,t.prev=2,t.next=5,F.post("/login",{username:this.username,password:this.password,device_name:this.deviceName});case 5:e=t.sent,e.data&&e.data.token&&(localStorage.setItem("api_token",e.data.token),localStorage.setItem("user_id",e.data.user.id),this.$router.push("/")),t.next=12;break;case 9:t.prev=9,t.t0=t["catch"](2),t.t0.response&&422===t.t0.response.status?this.errors=t.t0.response.data.errors||{}:this.errors.general="Login failed. Please check your credentials and try again.";case 12:return t.prev=12,this.loading=!1,t.finish(12);case 15:case"end":return t.stop()}}),t,this,[[2,9,12,15]])})));function e(){return t.apply(this,arguments)}return e}()}},L=R,I=(r("cc14"),r("2877")),N=Object(I["a"])(L,p,d,!1,null,"44503f32",null),E=N.exports,M=function(){var t=this,e=t._self._c;return t.user?e("div",{staticClass:"home-container"},[e("div",{staticClass:"welcome-message"},[t._v(" Welcome, "+t._s(t.user.surname)+" "+t._s(t.user.first_name)+" "+t._s(t.user.last_name)+" ")]),t.statistic.info?e("div",{domProps:{innerHTML:t._s(t.statistic.info)}}):t._e(),e("div",{staticClass:"button-container"},[e("button",{staticClass:"button check-in-button",on:{click:t.handleCheckLockIn}},[t._v("Check Lock In")]),e("button",{staticClass:"button check-out-button",on:{click:t.handleCheckLockOut}},[t._v("Check Lock Out")])]),e("div",{staticClass:"location-text"},[t._v(t._s(t.locationText))])]):t._e()},$=[],U=(r("8e6e"),r("456d"),r("ade3"));function q(t){return A.apply(this,arguments)}function A(){return A=Object(f["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e||!e.showLoc){t.next=4;break}return t.next=3,V();case 3:return t.abrupt("return",t.sent);case 4:return t.abrupt("return",new Promise((function(t,e){navigator.geolocation?navigator.geolocation.getCurrentPosition(function(){var e=Object(f["a"])(regeneratorRuntime.mark((function e(r){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t({position:r});case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),(function(t){e(new Error("Geolocation error: ".concat(t.message)))})):e(new Error("Geolocation is not supported by this browser."))})));case 5:case"end":return t.stop()}}),t)}))),A.apply(this,arguments)}function V(){return B.apply(this,arguments)}function B(){return B=Object(f["a"])(regeneratorRuntime.mark((function t(){var e,r,a,n,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,q();case 3:return e=t.sent,r=e.position,a="https://nominatim.openstreetmap.org/reverse?format=jsonv2&lat=".concat(r.coords.latitude,"&lon=").concat(r.coords.longitude),t.next=8,F.get(a);case 8:if(n=t.sent,n.data){t.next=11;break}throw new Error("Indobenua");case 11:return s=n.data,t.abrupt("return",{position:r,loc:s});case 15:throw t.prev=15,t.t0=t["catch"](0),new Error("Failed to fetch location details: ".concat(t.t0.message));case 18:case"end":return t.stop()}}),t,null,[[0,15]])}))),B.apply(this,arguments)}function H(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,a)}return r}function z(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?H(Object(r),!0).forEach((function(e){Object(U["a"])(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):H(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}var J={data:function(){return{loading:!0,errorMsg:null,position:null,locationDetails:null,deviceName:""}},computed:z(z({},Object(g["c"])(["user","statistic"])),{},{locationText:function(){return this.errorMsg?this.errorMsg:this.locationDetails?this.locationDetails.display_name:"Waiting.."}}),methods:{fetchLocation:function(){var t=Object(f["a"])(regeneratorRuntime.mark((function t(){var e,r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,q({showLoc:!0});case 3:e=t.sent,r=e.position,a=e.loc,this.position=r,this.locationDetails=a,t.next=14;break;case 10:t.prev=10,t.t0=t["catch"](0),console.error("Failed to fetch location:",t.t0),this.errorMsg=t.t0.message;case 14:case"end":return t.stop()}}),t,this,[[0,10]])})));function e(){return t.apply(this,arguments)}return e}(),handleCheckLockIn:function(){var t=Object(f["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,F.post("/check-lock",{latitude:this.position.coords.latitude,longitude:this.position.coords.longitude,description:"Check Lock In",name:"check_clock_in"});case 3:alert("Success","Check Lock In successful"),t.next=10;break;case 6:t.prev=6,t.t0=t["catch"](0),n.a.$toast.error(t.t0.message),console.error(t.t0);case 10:case"end":return t.stop()}}),t,this,[[0,6]])})));function e(){return t.apply(this,arguments)}return e}(),handleCheckLockOut:function(){var t=Object(f["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,F.post("/check-lock",{latitude:this.position.coords.latitude,longitude:this.position.coords.longitude,description:"Check Lock Out",name:"check_clock_out"});case 3:alert("Success","Check Lock Out successful"),t.next=10;break;case 6:t.prev=6,t.t0=t["catch"](0),n.a.$toast.error(t.t0.message),console.error(t.t0);case 10:case"end":return t.stop()}}),t,this,[[0,6]])})));function e(){return t.apply(this,arguments)}return e}()},mounted:function(){this.deviceName=v.a.name+" "+v.a.version,this.fetchLocation(),setTimeout((function(){localStorage.getItem("api_token")&&!document.querySelector(".nav-tabs")&&location.reload()}),5e3)}},G=J,W=(r("3109"),Object(I["a"])(G,M,$,!1,null,"0a5046de",null)),Y=W.exports,K=function(){var t=this,e=t._self._c;return e("div",{staticClass:"task-container"},[e("div",{staticClass:"header-container"},[e("div",{staticClass:"filter-container"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.searchText,expression:"searchText"}],staticClass:"input",attrs:{type:"text",placeholder:"Search..."},domProps:{value:t.searchText},on:{input:function(e){e.target.composing||(t.searchText=e.target.value)}}}),e("button",{staticClass:"filter",on:{click:t.toggleDateFilterModal}},[t._v(" "+t._s(t.dateFilter)+" ")]),e("button",{staticClass:"filter",style:{backgroundColor:t.getStatusFilterColor()},on:{click:t.toggleStatusFilterModal}},[t._v(" "+t._s(t.statusFilter)+" ")])])]),t.loading?e("div",{staticClass:"loading-indicator"},[t._m(0)]):t.filteredTasks.length?e("div",{staticClass:"tasks-list"},t._l(t.filteredTasks,(function(r,a){return e("div",{key:a,staticClass:"task-item"},[e("router-link",{staticClass:"task-link",attrs:{to:{name:"DetailTask",params:{task:r,id:r.id}}}},[e("div",{staticClass:"item",style:{backgroundColor:t.getStatusFilterColor()}},[e("div",{staticClass:"avatar"},[e("span",{staticClass:"avatar-text"},[t._v(t._s(r.store.store_code))])]),e("div",{staticClass:"item-content"},[e("div",{staticClass:"title"},[t._v(t._s(r.store.route.index_route)+". "+t._s(r.store.store_name))]),e("div",{staticClass:"description"},[t._v(t._s(r.trx_no)+" Periode: "+t._s(r.periode))]),e("div",{staticClass:"reminder"},[t._v(" "+t._s(r.previous_month_projects.reduce((function(t,e){return(t?"":"REMINDER: ")+e.note}),"").substr(0,50))+" ")])]),e("div",{staticClass:"right-column"},[e("div",{staticClass:"req-date"},[t._v(t._s(t.formatDate(r.req_date)))])])])])],1)})),0):e("div",{staticClass:"empty-message"},[e("div",[t._v("No tasks available.")])]),t.isDateFilterModalVisible?e("div",{staticClass:"modal-backdrop"},[e("div",{staticClass:"modal-container"},[e("button",{on:{click:function(e){return t.selectDateFilter("Hari Ini")}}},[t._v("Hari Ini")]),e("button",{on:{click:function(e){return t.selectDateFilter("Minggu Ini")}}},[t._v("Minggu Ini")]),e("button",{on:{click:function(e){return t.selectDateFilter("Bulan Ini")}}},[t._v("Bulan Ini")])])]):t._e(),t.isStatusFilterModalVisible?e("div",{staticClass:"modal-backdrop"},[e("div",{staticClass:"modal-container"},[e("button",{on:{click:function(e){return t.selectStatusFilter("Pending")}}},[t._v("Pending")]),e("button",{on:{click:function(e){return t.selectStatusFilter("Review")}}},[t._v("Review")]),e("button",{on:{click:function(e){return t.selectStatusFilter("Lengkap")}}},[t._v("Lengkap")])])]):t._e()])},Q=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"loading-text"},[e("div",{staticClass:"fa fa-spinner"})])}];r("55dd"),r("6762"),r("2fdb");function X(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,a)}return r}function Z(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?X(Object(r),!0).forEach((function(e){Object(U["a"])(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):X(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}var tt={data:function(){return{loading:!1,tasks:[],searchText:"",dateFilter:"Hari Ini",statusFilter:"Pending",isDateFilterModalVisible:!1,isStatusFilterModalVisible:!1}},computed:Z(Z({},Object(g["c"])(["statistic"])),{},{filteredTasks:function(){var t=this;return this.tasks.filter((function(e){return(e.store.store_name.toLowerCase().includes(t.searchText.toLowerCase())||e.task.subject.toLowerCase().includes(t.searchText.toLowerCase())||e.store.store_code.toLowerCase().includes(t.searchText.toLowerCase()))&&t.filterTasks(e)}))}}),methods:{fetchTasks:function(){var t=Object(f["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.loading=!0,t.prev=1,t.next=4,F.get("/task");case 4:return e=t.sent,this.tasks=e.data,t.next=8,x("tasks");case 8:return t.next=10,y("tasks",this.tasks);case 10:this.statistic.tasks=this.tasks,t.next=16;break;case 13:t.prev=13,t.t0=t["catch"](1),console.error("Error fetching tasks:",t.t0);case 16:return t.prev=16,this.loading=!1,t.finish(16);case 19:case"end":return t.stop()}}),t,this,[[1,13,16,19]])})));function e(){return t.apply(this,arguments)}return e}(),filterTasks:function(t){var e=this,r=new Date,a=new Date(t.req_date),n=function(){if("Hari Ini"===e.dateFilter)return a.toDateString()===r.toDateString();if("Minggu Ini"===e.dateFilter){var t=new Date(r.setDate(r.getDate()-r.getDay())),n=new Date(r.setDate(r.getDate()-r.getDay()+6));return a>=t&&a<=n}if("Bulan Ini"===e.dateFilter){var s=new Date(r.getFullYear(),r.getMonth(),1),i=new Date(r.getFullYear(),r.getMonth()+1,0);return a>=s&&a<=i}return!0}(),s=function(){return"Lengkap"===e.statusFilter?"completed"===t.task.status:"Review"===e.statusFilter?"in_progress"===t.task.status&&t.task.comments&&t.task.comments.length>0:"Pending"!==e.statusFilter||"in_progress"===t.task.status&&(!t.task.comments||0===t.task.comments.length)}();return"Hari Ini"===this.dateFilter&&"Pending"===this.statusFilter?a<=r&&s:n&&s},toggleDateFilterModal:function(){this.isDateFilterModalVisible=!this.isDateFilterModalVisible},toggleStatusFilterModal:function(){this.isStatusFilterModalVisible=!this.isStatusFilterModalVisible},selectDateFilter:function(t){this.dateFilter=t,this.isDateFilterModalVisible=!1},selectStatusFilter:function(t){this.statusFilter=t,this.isStatusFilterModalVisible=!1},getStatusFilterColor:function(){switch(this.statusFilter){case"Pending":return"#fff3b0";case"Review":return"#b2f0f0";case"Lengkap":return"#d4f8d4";default:return"#fff"}},formatDate:function(t){var e=new Date(t);return e.toLocaleDateString("id-ID",{day:"2-digit",month:"2-digit"})},checkDataTasks:function(){var t=Object(f["a"])(regeneratorRuntime.mark((function t(){var e,r,a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.loading=!0,t.next=3,j("tasks");case 3:if(e=t.sent,r=localStorage.getItem("lastUpdate_tasks"),a=(new Date).getTime(),n=r&&a-r>144e5,e.length&&!n){t.next=13;break}return t.next=10,this.fetchTasks();case 10:localStorage.setItem("lastUpdate_tasks",a),t.next=14;break;case 13:this.tasks=e.sort((function(t,e){return t.store.route.index_route-e.store.route.index_route}));case 14:this.statistic.task_count=this.tasks.filter((function(t){return"in_progress"===t.task.status&&!t.task.comments.length&&new Date(t.req_date).getDate()<=(new Date).getDate()})).length,this.loading=!1;case 16:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},mounted:function(){var t=Object(f["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:this.checkDataTasks();case 1:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},et=tt,rt=(r("aec2"),Object(I["a"])(et,K,Q,!1,null,"2541bdc8",null)),at=rt.exports,nt=function(){var t=this,e=t._self._c;return e("div",[e("div",{ref:"detailTaskContainer",staticClass:"detail-task-container"},[e("div",{staticClass:"header"},[e("router-link",{staticClass:"back-button",attrs:{to:"/task"}},[t._v("Back to Tasks")]),e("h1")],1),t.task?e("div",[e("div",{staticClass:"task-detail"},[e("h2",[t._v(t._s(t.task.store.store_name))]),e("p",[e("strong",[t._v("Kode Toko:")]),t._v(" "+t._s(t.task.store.store_code))]),e("p",[e("strong",[t._v("Rute:")]),t._v(" "+t._s(t.task.store.route.index_route))]),e("p",[e("strong",[t._v("Nomer Transaksi:")]),t._v(" "+t._s(t.task.trx_no))]),e("p",[e("strong",[t._v("Periode:")]),t._v(" "+t._s(t.task.periode))]),e("p",[e("strong",[t._v("Request Date:")]),t._v(" "+t._s(t.formatDate(t.task.req_date)))]),e("p",[e("strong",[t._v("Status:")]),t._v(" "+t._s(t.task.task.status))])]),e("div",{staticClass:"infoContainer"},[e("div",{staticClass:"infoBox"},[e("div",{staticClass:"infoTitle"},[t._v("Catatan bulan lalu:")]),e("div",{staticClass:"red-text"},[t._v(" "+t._s(t.task.previous_month_projects&&t.task.previous_month_projects.length?t.task.previous_month_projects.reduce((function(t,e){return t+e.note}),"").reduce((function(t,e){return t+e.note}),""):"")+" ")])]),e("div",{staticClass:"infoBox"},[e("div",{staticClass:"infoTitle"},[t._v("Tambahkan Catatan bulan ini:")]),e("Modal",{attrs:{isVisible:t.isModalVisible,task:t.task},on:{close:t.closeModal,success:t.handleSuccess}}),e("div",{staticClass:"red-text",on:{click:t.openModal}},[t.task.note?e("span",[t._v(" "+t._s(t.task.note)+"  "),e("i",{staticClass:"fas fa-edit"})]):e("span",{staticClass:"icon-plus danger",on:{click:t.openModal}},[e("i",{staticClass:"fas fa-plus-circle"})])])],1)]),e("hr"),e("div",[e("ul",{ref:"commentList",staticClass:"comment-list"},t._l(t.comments,(function(r,a){return e("li",{key:a},[e("div",{class:{"comment-content current-user-content":r.commented_by.id===t.currentUserId,"comment-content other-user-content":r.commented_by.id!==t.currentUserId}},[e("div",{staticClass:"comment-header"},[e("span",{staticClass:"commented-by"},[t._v(t._s(r.commented_by.nickname))]),e("span",{staticClass:"comment-time"},[t._v(t._s(r.created_at))])]),r.media&&r.media.length?e("div",{staticClass:"comment-images"},t._l(r.media,(function(t,r){return e("img",{key:r,staticClass:"comment-image",attrs:{src:t.display_url,alt:"Comment image "+r,title:t.display_name}})})),0):t._e(),t._v(" "+t._s(r.comment)+" ")])])})),0)])]):e("div",{staticClass:"loading-indicator"},[e("i",{staticClass:"fa fa-spinner fa-spin"})])]),t.previewImages.length?e("div",{staticClass:"preview-image-container"},t._l(t.previewImages,(function(r,a){return e("div",{key:a,staticClass:"preview-image-wrapper"},[e("img",{staticClass:"preview-image",attrs:{src:r.data,alt:r.name}}),e("span",{staticClass:"remove-image",on:{click:function(e){return t.removePreviewImage(a)}}},[t._v("×")])])})),0):t._e(),e("div",{staticClass:"input-form"},[e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.additionalText,expression:"additionalText"}],staticClass:"text-input",attrs:{placeholder:"Tambahkan pesan..."},domProps:{value:t.additionalText},on:{input:function(e){e.target.composing||(t.additionalText=e.target.value)}}}),e("div",{staticClass:"icons"},[e("label",{staticClass:"file-upload-button",attrs:{for:"file-upload"}},[e("i",{staticClass:"fas fa-paperclip"}),e("input",{ref:"fileUpload",staticStyle:{display:"none"},attrs:{id:"file-upload",type:"file",multiple:""},on:{change:t.handleFileUpload}})]),e("button",{staticClass:"send-button",on:{click:t.submitData}},[e("i",{staticClass:"fas fa-paper-plane"})])])])])},st=[],it=(r("5df3"),r("1c4c"),function(){var t=this,e=t._self._c;return t.isVisible?e("div",{staticClass:"modal-overlay",on:{click:function(e){return e.target!==e.currentTarget?null:t.closeModal.apply(null,arguments)}}},[e("div",{staticClass:"modal-content"},[e("span",{staticClass:"close",on:{click:t.closeModal}},[t._v("×")]),e("h2",{staticClass:"reminder-title"},[t._v("Add Reminder")]),e("form",{on:{submit:function(e){return e.preventDefault(),t.submitForm.apply(null,arguments)}}},[e("div",{staticClass:"form-group"},[t._m(0),e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.reminderText,expression:"reminderText"}],attrs:{placeholder:"Tulis disini",id:"reminder",required:""},domProps:{value:t.reminderText},on:{input:function(e){e.target.composing||(t.reminderText=e.target.value)}}})]),e("button",{staticClass:"btn-submit-modal",attrs:{type:"submit"}},[t._v("Simpan!")])])])]):t._e()}),ot=[function(){var t=this,e=t._self._c;return e("label",{attrs:{for:"reminder"}},[e("small",[t._v("Untuk pengingat bulan depan:")])])}];function ct(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,a)}return r}function lt(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?ct(Object(r),!0).forEach((function(e){Object(U["a"])(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ct(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}var ut={name:"Modal",props:["isVisible","task"],data:function(){return{reminderText:""}},methods:{closeModal:function(){this.$emit("close")},submitForm:function(){var t=Object(f["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.$axios.post("/reminder/"+this.task.id,{reminder_message:this.reminderText});case 3:e=t.sent,200===e.status&&(this.$emit("success",lt(lt({},e.data),{},{reminderText:this.reminderText})),this.closeModal()),t.next=10;break;case 7:t.prev=7,t.t0=t["catch"](0),console.error("Error submitting reminder:",t.t0);case 10:case"end":return t.stop()}}),t,this,[[0,7]])})));function e(){return t.apply(this,arguments)}return e}()},created:function(){this.reminderText=this.task.note}},pt=ut,dt=(r("64a4"),Object(I["a"])(pt,it,ot,!1,null,null,null)),ft=dt.exports,mt={components:{Modal:ft},data:function(){return{task:this.$route.params.task||null,additionalText:"",previewImages:[],isModalVisible:!1,currentUserId:JSON.parse(localStorage.getItem("user_id")||"1")}},created:function(){var t=Object(f["a"])(regeneratorRuntime.mark((function t(){var e,r=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(this.task){t.next=5;break}return e=this.$route.params.id,t.next=4,this.fetchTask(e);case 4:this.task=t.sent;case 5:this.comments=this.task.task.comments||[],setTimeout((function(){r.scrollToBottom()}),500);case 7:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),methods:{fetchTask:function(){var t=Object(f["a"])(regeneratorRuntime.mark((function t(e){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.loading=!0,t.prev=1,t.next=4,F.get("/task/".concat(e));case 4:return r=t.sent,t.abrupt("return",r.data[0]);case 8:t.prev=8,t.t0=t["catch"](1),console.error("Error fetching service call:",t.t0),n.a.$toast.error("Error","Gagal memuat data service call.");case 12:return t.prev=12,this.loading=!1,t.finish(12);case 15:case"end":return t.stop()}}),t,this,[[1,8,12,15]])})));function e(e){return t.apply(this,arguments)}return e}(),formatDate:function(t){var e=new Date(t);return e.toLocaleDateString("id-ID")},handleFileUpload:function(t){var e=this,r=Array.from(t.target.files);r.forEach((function(t){var r=new FileReader;r.onload=function(r){e.previewImages.push({name:t.name,data:r.target.result,file:t})},r.readAsDataURL(t)}))},removePreviewImage:function(t){this.previewImages.splice(t,1)},submitData:function(){var t=Object(f["a"])(regeneratorRuntime.mark((function t(){var e,r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(this.additionalText.trim()){t.next=3;break}return n.a.$toast.error("Tambahkan pesan terlebih dahulu"),t.abrupt("return");case 3:return e=new FormData,e.append("alfa_id",this.task.id),e.append("task_id",this.task.task.id),e.append("comment",this.additionalText),this.previewImages.forEach((function(t){e.append("photos[]",t.file,t.name)})),t.prev=8,t.next=11,F.post("/task",e,{headers:{"Content-Type":"multipart/form-data"}});case 11:if(r=t.sent,a=r.data,!a.success){t.next=20;break}return this.comments=a.data.comments,this.additionalText="",this.previewImages=[],this.scrollToBottom(),t.next=20,P("tasks",this.task.id,this.comments,"comments");case 20:t.next=25;break;case 22:t.prev=22,t.t0=t["catch"](8),console.error("Error submitting data:",t.t0);case 25:case"end":return t.stop()}}),t,this,[[8,22]])})));function e(){return t.apply(this,arguments)}return e}(),openModal:function(){this.isModalVisible=!0},closeModal:function(){this.isModalVisible=!1},handleSuccess:function(){var t=Object(f["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.success){t.next=4;break}return this.task.note=e.reminderText,t.next=4,P("tasks",this.task.id,e.reminderText,"note");case 4:console.log("Reminder added successfully:",e);case 5:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),scrollToBottom:function(){var t=this;this.$nextTick((function(){var e=t.$refs.detailTaskContainer;setTimeout((function(){e.scrollTop=e.scrollHeight}),200)}))}}},vt=mt,ht=(r("d625"),Object(I["a"])(vt,nt,st,!1,null,"60c5c956",null)),gt=ht.exports,bt=function(){var t=this,e=t._self._c;return e("div",{staticClass:"container"},[e("div",{staticClass:"filter-container"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.searchText,expression:"searchText"}],staticClass:"input",attrs:{placeholder:"Search..."},domProps:{value:t.searchText},on:{input:function(e){e.target.composing||(t.searchText=e.target.value)}}}),e("button",{staticClass:"filter",style:{backgroundColor:t.getStatusFilterColor()},on:{click:function(e){t.isStatusFilterModalVisible=!0}}},[t._v(" "+t._s(t.statusFilter)+" ")])]),e("transition",{attrs:{name:"fade"}},[t.isStatusFilterModalVisible?e("div",{staticClass:"modal"},[e("div",{staticClass:"modal-backdrop",on:{click:function(e){t.isStatusFilterModalVisible=!1}}}),e("div",{staticClass:"modal-container"},[e("button",{staticClass:"pending",on:{click:function(e){return t.setStatusFilter("Pending")}}},[t._v("Pending")]),e("button",{staticClass:"progress",on:{click:function(e){return t.setStatusFilter("Progress")}}},[t._v("Progress")]),e("button",{staticClass:"solved",on:{click:function(e){return t.setStatusFilter("Solved")}}},[t._v("Solved")])])]):t._e()]),t.loading?e("div",{staticClass:"loading-indicator"},[e("i",{staticClass:"fa fa-spinner fa-spin"})]):e("div",[t.filteredServiceCalls.length?e("ul",{staticClass:"service-call-list"},t._l(t.filteredServiceCalls,(function(r,a){return e("li",{key:a,staticClass:"service-call-item",style:{backgroundColor:t.getStatusFilterColor()},on:{click:function(e){return t.navigateToDetail(r)}}},[t._m(0,!0),e("div",{staticClass:"item-content"},[e("p",{staticClass:"title"},[t._v(t._s(r.store&&r.store.store_code)+" "+t._s(r.store&&r.store.store_name))]),e("p",{staticClass:"description"},[t._v(t._s(r.subject))])]),e("div",{staticClass:"right-column"},[e("p",{staticClass:"tgl"},[t._v(t._s(t.formatDate(r.trx_date)))])])])})),0):e("div",{staticClass:"centered-view"},[e("p",{staticClass:"centered-text"},[t._v("Tidak ada service call saat ini.")])])])],1)},kt=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"avatar"},[e("i",{staticClass:"fa fa-phone",attrs:{"aria-hidden":"true"}})])}];function _t(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,a)}return r}function wt(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?_t(Object(r),!0).forEach((function(e){Object(U["a"])(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):_t(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}var Ct={data:function(){return{loading:!1,serviceCalls:[],searchText:"",statusFilter:"Pending",isStatusFilterModalVisible:!1}},computed:wt(wt({},Object(g["c"])(["statistic"])),{},{filteredServiceCalls:function(){var t=this;return this.serviceCalls.filter((function(e){return(e.store&&e.store.store_name.toLowerCase().includes(t.searchText.toLowerCase())||e.store&&e.store.store_code.toLowerCase().includes(t.searchText.toLowerCase())||e.subject&&e.subject.toLowerCase().includes(t.searchText.toLowerCase()))&&t.filterServiceCalls(e)}))}}),methods:{fetchServiceCalls:function(){var t=Object(f["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.loading=!0,t.prev=1,t.next=4,F.get("/service-call");case 4:return e=t.sent,this.serviceCalls=e.data,t.next=8,x("serviceCalls");case 8:return t.next=10,y("serviceCalls",this.serviceCalls);case 10:t.next=16;break;case 12:t.prev=12,t.t0=t["catch"](1),n.a.$toast.error("Error fetching service calls:"),console.log("Error fetching service calls:",t.t0);case 16:return t.prev=16,this.loading=!1,t.finish(16);case 19:case"end":return t.stop()}}),t,this,[[1,12,16,19]])})));function e(){return t.apply(this,arguments)}return e}(),filterServiceCalls:function(t){return"Pending"===this.statusFilter?"pending"===t.status:"Progress"===this.statusFilter?"in_progress"===t.status:"Solved"!==this.statusFilter||"solved"===t.status},getStatusFilterColor:function(){switch(this.statusFilter){case"Pending":return"#ffebcc";case"Progress":return"#52e5ed";case"Solved":return"#d4f8d4";default:return"#fff"}},setStatusFilter:function(t){this.statusFilter=t,this.isStatusFilterModalVisible=!1},formatDate:function(t){return t.replace(/(\d{4})-(\d{2})-(\d{2})/,"$3/$2")},navigateToDetail:function(t){this.$router.push({name:"DetailServiceCall",params:{serviceCall:t,id:t.id}})},checkDataSC:function(){var t=Object(f["a"])(regeneratorRuntime.mark((function t(){var e,r,a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,j("serviceCalls");case 2:if(e=t.sent,r=localStorage.getItem("lastUpdate_sc"),a=(new Date).getTime(),n=r&&a-r>144e5,e.length&&!n){t.next=12;break}return t.next=9,this.fetchServiceCalls();case 9:localStorage.setItem("lastUpdate_sc",a),t.next=13;break;case 12:this.serviceCalls=e;case 13:this.statistic.sc_count=this.serviceCalls.filter((function(t){return"pending"===t.status})).length;case 14:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},mounted:function(){this.checkDataSC()}},Ot=Ct,yt=(r("98e8"),Object(I["a"])(Ot,bt,kt,!1,null,"18566106",null)),jt=yt.exports,xt=function(){var t=this,e=t._self._c;return t.serviceCall?e("div",{staticClass:"container"},[e("header",{staticClass:"header"},[e("h1",[t._v(t._s(t.serviceCall.store.store_code)+" "+t._s(t.serviceCall.store.store_name))])]),t.loading?e("div",{staticClass:"indicator"},[e("span",[t._v("Loading...")])]):e("div",[e("div",{staticClass:"content"},[e("div",{staticClass:"details"},[e("div",{staticClass:"detail-row"},[e("i",{staticClass:"fa fa-calendar"}),e("span",[t._v(t._s(t.formatDate(t.serviceCall.trx_date)))])]),e("div",{staticClass:"detail-row"},[e("i",{staticClass:"fa fa-info-circle"}),e("span",[t._v(t._s(t.serviceCall.status))])]),e("div",{staticClass:"detail-row"},[e("i",{staticClass:"fa fa-phone"}),e("span",[t._v(t._s(t.serviceCall.pic))])]),e("div",{staticClass:"detail-row"},[e("i",{staticClass:"fa fa-file-text"}),e("span",[t._v(t._s(t.serviceCall.subject))])]),e("div",{staticClass:"detail-row"},[e("i",{staticClass:"fa fa-bank"}),e("span",[t._v(t._s(t.serviceCall.store.address))])])]),t._l(t.lines,(function(r){return e("div",{key:r.id,staticClass:"line-container"},[e("h2",[t._v("Unit No: "+t._s(r.unit_no))]),e("h3",[t._v("Complain Details: "+t._s(r.complain_details))]),e("input",{directives:[{name:"model",rawName:"v-model",value:r.trouble_causer,expression:"line.trouble_causer"}],staticClass:"input",attrs:{placeholder:"Penyebab",required:""},domProps:{value:r.trouble_causer},on:{input:function(e){e.target.composing||t.$set(r,"trouble_causer",e.target.value)}}}),e("input",{directives:[{name:"model",rawName:"v-model",value:r.solution,expression:"line.solution"}],staticClass:"input",attrs:{placeholder:"Solusi",required:""},domProps:{value:r.solution},on:{input:function(e){e.target.composing||t.$set(r,"solution",e.target.value)}}}),e("div",{staticClass:"photo-container"},[e("button",{staticStyle:{"font-size":"x-large"},on:{click:function(e){return t.handleAddPhotos(r.id)}}},[e("i",{staticClass:"fa fa-camera"})]),t._l(r.photos,(function(t,r){return e("div",{key:r,staticClass:"photo-preview"},[t.document_name?e("img",{staticClass:"photo",attrs:{src:"https://ac.igm.biz.id/public/uploads/media/"+t.document_name}}):e("img",{staticClass:"photo",attrs:{src:t.uri}})])}))],2)])})),e("div",{staticClass:"button-container"},[e("button",{staticClass:"button cancel-button",on:{click:t.handleCancel}},[t._v("Batal")]),e("button",{staticClass:"button",on:{click:t.handleSave}},[t._v("Simpan")])])],2)])]):t._e()},Pt=[],Dt=r("2909");function St(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,a)}return r}function Tt(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?St(Object(r),!0).forEach((function(e){Object(U["a"])(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):St(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}var Ft={data:function(){return{loading:!1,serviceCall:this.$route.params.serviceCall||null,lines:[]}},created:function(){var t=Object(f["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(this.serviceCall){t.next=6;break}return e=this.$route.params.id,t.next=4,this.fetchServiceCall(e);case 4:t.next=7;break;case 6:this.initializeLines(this.serviceCall.lines);case 7:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),methods:{fetchServiceCall:function(){var t=Object(f["a"])(regeneratorRuntime.mark((function t(e){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.loading=!0,t.prev=1,t.next=4,F.get("/service-call/".concat(e));case 4:r=t.sent,this.serviceCall=r.data,this.initializeLines(this.serviceCall.lines),t.next=13;break;case 9:t.prev=9,t.t0=t["catch"](1),console.error("Error fetching service call:",t.t0),n.a.$toast.error("Error","Gagal memuat data service call.");case 13:return t.prev=13,this.loading=!1,t.finish(13);case 16:case"end":return t.stop()}}),t,this,[[1,9,13,16]])})));function e(e){return t.apply(this,arguments)}return e}(),initializeLines:function(t){this.lines=t.map((function(t){return Tt({},t)}))},formatDate:function(t){var e={year:"numeric",month:"long",day:"numeric"};return new Date(t).toLocaleDateString(void 0,e)},handleInputChange:function(t,e,r){this.lines=this.lines.map((function(a){return a.id===t?Tt(Tt({},a),{},Object(U["a"])({},e,r)):a}))},handleAddPhotos:function(){var t=Object(f["a"])(regeneratorRuntime.mark((function t(e){var r,a=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:r=document.createElement("input"),r.type="file",r.accept="image/*",r.multiple=!0,r.onchange=function(t){for(var r=t.target.files,n=[],s=function(){var t=r[i],s=new FileReader;s.onload=function(s){n.push({uri:s.target.result,file:t}),n.length===r.length&&(a.lines=a.lines.map((function(t){return t.id===e?Tt(Tt({},t),{},{photos:[].concat(Object(Dt["a"])(t.photos),n)}):t})))},s.readAsDataURL(t)},i=0;i<r.length;i++)s()},r.click();case 6:case"end":return t.stop()}}),t)})));function e(e){return t.apply(this,arguments)}return e}(),handleSave:function(){var t=Object(f["a"])(regeneratorRuntime.mark((function t(){var e,r,a,s,i,o,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.loading=!0,t.prev=1,e=new FormData,e.append("sc_id",this.serviceCall.id),t.next=6,q();case 6:if(r=t.sent,a=r.position,a&&e.append("position",JSON.stringify(a)),s=this.lines.filter((function(t){return t.photos.length})).length,s){t.next=12;break}return t.abrupt("return",n.a.$toast.error("Masukkan Photo!"));case 12:if(i=this.lines.filter((function(t){return!!t.solution})).length,i){t.next=15;break}return t.abrupt("return",n.a.$toast.error("Solusi tidak boleh kosong!"));case 15:return this.lines.forEach((function(t,r){t.photos.forEach((function(t){t.file&&e.append("lines[".concat(r,"][photos][]"),t.file)})),e.append("lines[".concat(r,"][solution]"),t.solution),e.append("lines[".concat(r,"][trouble_causer]"),t.trouble_causer)})),t.next=18,F.post("/service-call/update",e,{headers:{"Content-Type":"multipart/form-data"}});case 18:return o=t.sent,c=o.data,t.next=22,P("serviceCalls",this.serviceCall.id,c,"sc");case 22:n.a.$toast.success("Berhasil disimpan"),this.$router.push({name:"ServiceCall",params:{serviceCall:this.serviceCall}}),t.next=30;break;case 26:t.prev=26,t.t0=t["catch"](1),console.error("Error saving data:",t.t0),n.a.$toast.error("Error","Terjadi kesalahan saat menyimpan data");case 30:return t.prev=30,this.loading=!1,t.finish(30);case 33:case"end":return t.stop()}}),t,this,[[1,26,30,33]])})));function e(){return t.apply(this,arguments)}return e}(),handleCancel:function(){this.$router.push({name:"ServiceCall",params:{serviceCall:this.serviceCall}})}}},Rt=Ft,Lt=(r("14c9"),Object(I["a"])(Rt,xt,Pt,!1,null,"0409d18e",null)),It=Lt.exports,Nt=function(){var t=this,e=t._self._c;return e("div",{staticClass:"safe-area"},[e("router-link",{attrs:{to:{name:"EditProfile",params:{userData:t.userData}}}},[e("button",{staticClass:"edit-button"},[e("i",{staticClass:"fa fa-edit edit-btn"})])]),e("div",{staticClass:"profile-container"},[e("img",{staticClass:"profile-image",attrs:{src:t.userData&&t.userData.media?t.userData.media.display_url:"/assets/images/default_profile.png",alt:"Profile Image"}}),e("h1",{staticClass:"title"},[t._v("Profile")]),t.userData?e("div",{staticClass:"data-profile-container"},[e("div",{staticClass:"info-container"},[e("span",{staticClass:"label"},[t._v("Name:")]),e("span",{staticClass:"value"},[t._v(t._s(t.userData.surname)+" "+t._s(t.userData.first_name)+" "+t._s(t.userData.last_name))])]),e("div",{staticClass:"info-container"},[e("span",{staticClass:"label"},[t._v("Username:")]),e("span",{staticClass:"value"},[t._v(t._s(t.userData.username))])]),e("div",{staticClass:"info-container"},[e("span",{staticClass:"label"},[t._v("Email:")]),e("span",{staticClass:"value"},[t._v(t._s(t.userData.email))])]),e("div",{staticClass:"info-container"},[e("span",{staticClass:"label"},[t._v("Jabatan:")]),e("span",{staticClass:"value"},[t._v(t._s(t.userData.jabatan.name))])]),e("div",{staticClass:"logout-button-container"},[e("button",{on:{click:t.handleLogout}},[t._v("Logout")])])]):t._e()])],1)},Et=[],Mt={setup:function(){var t=Object(a["ref"])(null),e=Object(a["ref"])(!0),r=function(){var t=Object(f["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.value=!0,t.prev=1,t.next=4,F.post("/logout");case 4:localStorage.clear(),location.replace("/login"),t.next=11;break;case 8:t.prev=8,t.t0=t["catch"](1),console.error("Logout failed:",t.t0);case 11:return t.prev=11,e.value=!1,t.finish(11);case 14:case"end":return t.stop()}}),t,null,[[1,8,11,14]])})));return function(){return t.apply(this,arguments)}}(),n=function(){var r=Object(f["a"])(regeneratorRuntime.mark((function r(){var a;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,F.get("/user");case 3:a=r.sent,t.value=a.data,r.next=10;break;case 7:r.prev=7,r.t0=r["catch"](0),console.error("Error fetching user data:",r.t0);case 10:return r.prev=10,e.value=!1,r.finish(10);case 13:case"end":return r.stop()}}),r,null,[[0,7,10,13]])})));return function(){return r.apply(this,arguments)}}();return Object(a["onMounted"])((function(){n()})),{userData:t,loading:e,handleLogout:r}}},$t=Mt,Ut=(r("1487"),Object(I["a"])($t,Nt,Et,!1,null,"4ece3d8e",null)),qt=Ut.exports,At=function(){var t=this,e=t._self._c;return e("div",{staticClass:"safe-area"},[e("div",{staticClass:"custom-header"}),e("div",{staticClass:"form-container"},[e("div",{staticClass:"image-container"},[e("img",{staticClass:"profile-image",attrs:{src:t.profilePhoto?t.profilePhoto.uri:t.userData&&t.userData.media?t.userData.media.display_url:"/assets/images/default_profile.png",alt:"Profile Image"}}),e("button",{staticClass:"edit-icon",on:{click:t.pickImage}},[e("i",{staticClass:"fa fa-edit"})]),e("input",{ref:"fileInput",staticStyle:{display:"none"},attrs:{type:"file",accept:"image/*"},on:{change:t.handleFileChange}})]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.surName,expression:"surName"}],staticClass:"input",attrs:{placeholder:"SurName"},domProps:{value:t.surName},on:{input:function(e){e.target.composing||(t.surName=e.target.value)}}}),e("input",{directives:[{name:"model",rawName:"v-model",value:t.firstName,expression:"firstName"}],staticClass:"input",attrs:{placeholder:"First Name"},domProps:{value:t.firstName},on:{input:function(e){e.target.composing||(t.firstName=e.target.value)}}}),e("input",{directives:[{name:"model",rawName:"v-model",value:t.lastName,expression:"lastName"}],staticClass:"input",attrs:{placeholder:"Last Name"},domProps:{value:t.lastName},on:{input:function(e){e.target.composing||(t.lastName=e.target.value)}}}),e("input",{directives:[{name:"model",rawName:"v-model",value:t.email,expression:"email"}],staticClass:"input",attrs:{placeholder:"Email"},domProps:{value:t.email},on:{input:function(e){e.target.composing||(t.email=e.target.value)}}}),e("input",{directives:[{name:"model",rawName:"v-model",value:t.currentPassword,expression:"currentPassword"}],staticClass:"input",attrs:{type:"password",placeholder:"Current Password"},domProps:{value:t.currentPassword},on:{input:function(e){e.target.composing||(t.currentPassword=e.target.value)}}}),e("input",{directives:[{name:"model",rawName:"v-model",value:t.password,expression:"password"}],staticClass:"input",attrs:{type:"password",placeholder:"Password"},domProps:{value:t.password},on:{input:function(e){e.target.composing||(t.password=e.target.value)}}}),e("input",{directives:[{name:"model",rawName:"v-model",value:t.confirmPassword,expression:"confirmPassword"}],staticClass:"input",attrs:{type:"password",placeholder:"Confirm Password"},domProps:{value:t.confirmPassword},on:{input:function(e){e.target.composing||(t.confirmPassword=e.target.value)}}}),e("button",{staticClass:"save-button",on:{click:t.handleSave}},[t._v("Simpan")])]),t.loading?e("div",{staticClass:"loading-overlay"},[e("i",{staticClass:"fa fa-spinner fa-spin"})]):t._e()])},Vt=[],Bt={setup:function(){var t=Object(a["ref"])(null),e=Object(a["ref"])(t.surname||""),r=Object(a["ref"])(t.first_name||""),s=Object(a["ref"])(t.last_name||""),i=Object(a["ref"])(t.email||""),o=Object(a["ref"])(""),c=Object(a["ref"])(""),l=Object(a["ref"])(""),u=Object(a["ref"])(t.profile_photo||null),p=Object(a["ref"])(!1),d=Object(a["ref"])(null),m=function(){var t=Object(f["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:d.value.click();case 1:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),v=function(t){var e=t.target.files[0];if(e){var r=new FileReader;r.onload=function(){u.value={uri:URL.createObjectURL(e),file:e}},r.readAsDataURL(e)}},h=function(){var t=Object(f["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:n.a.$toast.success("Password berhasil diubah"),localStorage.clear(),location.replace("/login");case 3:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),g=function(){var t=Object(f["a"])(regeneratorRuntime.mark((function t(){var a,d;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(o.value===c.value){t.next=3;break}return n.a.$toast.error("Password tidak sama!"),t.abrupt("return");case 3:if(!o.value||l.value){t.next=6;break}return n.a.$toast.error("Passwords tidak boleh kosong!"),t.abrupt("return");case 6:return p.value=!0,t.prev=7,a=new FormData,a.append("surname",e.value),a.append("first_name",r.value),a.append("last_name",s.value),a.append("email",i.value),o.value&&(a.append("password",o.value),a.append("current_password",l.value)),u.value&&u.value.file&&a.append("profile_photo",u.value.file),t.next=17,F.post("/user",a,{headers:{"Content-Type":"multipart/form-data"}});case 17:if(d=t.sent,200!==d.status){t.next=28;break}if(!d.data.password_changed){t.next=22;break}return h(),t.abrupt("return");case 22:if(!d.data.error){t.next=25;break}return n.a.$toast.error(d.data.msg),t.abrupt("return");case 25:n.a.$toast.success("Profile berhasil diupdate"),t.next=29;break;case 28:n.a.$toast.error("Failed to update profile");case 29:t.next=35;break;case 31:t.prev=31,t.t0=t["catch"](7),console.error("Error updating profile:",t.t0),n.a.$toast.error("Failed to update profile");case 35:return t.prev=35,p.value=!1,t.finish(35);case 38:case"end":return t.stop()}}),t,null,[[7,31,35,38]])})));return function(){return t.apply(this,arguments)}}(),b=function(){var e=Object(f["a"])(regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,F.get("/user");case 3:r=e.sent,t.value=r.data,e.next=10;break;case 7:e.prev=7,e.t0=e["catch"](0),console.error("Error fetching user data:",e.t0);case 10:return e.prev=10,p.value=!1,e.finish(10);case 13:case"end":return e.stop()}}),e,null,[[0,7,10,13]])})));return function(){return e.apply(this,arguments)}}();return Object(a["onMounted"])((function(){b()})),Object(a["watch"])(t,(function(t){t&&(e.value=t.surname||"",r.value=t.first_name||"",s.value=t.last_name||"",i.value=t.email||"",u.value=t.profile_photo||null)})),{userData:t,surName:e,firstName:r,lastName:s,email:i,password:o,confirmPassword:c,currentPassword:l,profilePhoto:u,loading:p,pickImage:m,handleFileChange:v,handleSave:g,fileInput:d}}},Ht=Bt,zt=(r("a7df"),Object(I["a"])(Ht,At,Vt,!1,null,"1149248b",null)),Jt=zt.exports,Gt=[{path:"/",exact:!0,component:Y,icon:"home",name:"Home",meta:{requiresAuth:!0}},{path:"/task",exact:!0,component:at,icon:"psychology",name:"Task",meta:{requiresAuth:!0}},{path:"/task/:id",exact:!0,component:gt,icon:"psychology",name:"DetailTask",meta:{requiresAuth:!0}},{path:"/service-call",exact:!0,component:jt,icon:"psychology",name:"ServiceCall",meta:{requiresAuth:!0}},{path:"/service-call/:id",exact:!0,component:It,icon:"psychology",name:"DetailServiceCall",meta:{requiresAuth:!0}},{path:"/profile",exact:!0,component:qt,icon:"psychology",name:"Profile",meta:{requiresAuth:!0}},{path:"/edit-profile",exact:!0,component:Jt,icon:"psychology",name:"EditProfile",meta:{requiresAuth:!0}},{path:"/login",exact:!0,component:E,icon:"question_answer",name:"Login"},{path:"*",redirect:"/"}],Wt=new i["a"]({routes:Gt,mode:"history"});Wt.beforeEach((function(t,e,r){var a=localStorage.getItem("api_token");t.matched.some((function(t){return t.meta.requiresAuth}))&&!a?r("/login"):r()}));var Yt=Wt,Kt=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"app"}},[e("Header"),e("NavTabs"),e("router-view"),e("Spinner")],1)},Qt=[],Xt=function(){var t=this,e=t._self._c;return t.isLoggedIn?e("header",{staticClass:"header"},[t._m(0),e("div",{staticClass:"date"},[t._v(" "+t._s(t.currentDate)+" ")])]):t._e()},Zt=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"logo"},[e("span",{staticClass:"logo-text"},[t._v("INDOBENUA")])])}];function te(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,a)}return r}function ee(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?te(Object(r),!0).forEach((function(e){Object(U["a"])(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):te(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}var re={name:"Header",computed:ee({},Object(g["c"])({isLoggedIn:function(t){return!!t.user}})),data:function(){return{currentDate:""}},mounted:function(){this.updateCurrentDate()},methods:{updateCurrentDate:function(){var t=new Date,e={weekday:"long",year:"numeric",month:"long",day:"numeric"};this.currentDate=t.toLocaleDateString("id-ID",e)}}},ae=re,ne=(r("88cc"),Object(I["a"])(ae,Xt,Zt,!1,null,"7602e895",null)),se=ne.exports,ie=function(){var t=this,e=t._self._c;return t.isLoggedIn?e("nav",{staticClass:"nav-tabs"},[e("router-link",{staticClass:"nav-link",attrs:{to:"/"}},[t._v("Home")]),e("router-link",{staticClass:"nav-link",attrs:{to:"/task"}},[t._v(" Task "),t.statistics.task_count?e("span",{staticClass:"badge"},[t._v(t._s(t.statistics.task_count))]):t._e()]),e("router-link",{staticClass:"nav-link",attrs:{to:"/service-call"}},[t._v(" Service Call "),t.statistics.sc_count?e("span",{staticClass:"badge"},[t._v(t._s(t.statistics.sc_count))]):t._e()]),e("router-link",{staticClass:"nav-link",attrs:{to:"/profile"}},[t._v("Profile")])],1):t._e()},oe=[];function ce(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,a)}return r}function le(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?ce(Object(r),!0).forEach((function(e){Object(U["a"])(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ce(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}var ue={name:"NavTabs",computed:le({},Object(g["c"])({isLoggedIn:function(t){return!!t.user},statistics:function(t){return t.statistic}}))},pe=ue,de=(r("c4d3"),Object(I["a"])(pe,ie,oe,!1,null,"28a02daf",null)),fe=de.exports,me=function(){var t=this,e=t._self._c;return t.isLoading?e("div",{staticClass:"spinner-overlay"},[e("div",{staticClass:"spinner"})]):t._e()},ve=[];function he(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,a)}return r}function ge(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?he(Object(r),!0).forEach((function(e){Object(U["a"])(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):he(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}var be={computed:ge({},Object(g["c"])({isLoading:function(t){return t.isLoading}}))},ke=be,_e=(r("f364"),Object(I["a"])(ke,me,ve,!1,null,"3ac66530",null)),we=_e.exports;function Ce(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,a)}return r}function Oe(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Ce(Object(r),!0).forEach((function(e){Object(U["a"])(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Ce(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}var ye={name:"App",components:{Header:se,NavTabs:fe,Spinner:we},created:function(){this.fetchUser(),this.setStatistic()},methods:Oe({},Object(g["b"])(["fetchUser","setStatistic"]))},je=ye,xe=(r("a9a5"),Object(I["a"])(je,Kt,Qt,!1,null,null,null)),Pe=xe.exports;n.a.use(u["default"]),n.a.config.productionTip=!1,n.a.prototype.$axios=F,new n.a({store:b,router:Yt,render:function(t){return t(Pe)}}).$mount("#app")},"64a4":function(t,e,r){"use strict";r("fe92")},"88cc":function(t,e,r){"use strict";r("3b1f")},"912d":function(t,e,r){},"98e8":function(t,e,r){"use strict";r("cd47")},a7df:function(t,e,r){"use strict";r("f97f")},a9a5:function(t,e,r){"use strict";r("df60")},aec2:function(t,e,r){"use strict";r("3bf6")},b8f9:function(t,e,r){},c4d3:function(t,e,r){"use strict";r("43d4")},cc14:function(t,e,r){"use strict";r("5358")},cd47:function(t,e,r){},d4e4:function(t,e,r){},d625:function(t,e,r){"use strict";r("0408")},df60:function(t,e,r){},f364:function(t,e,r){"use strict";r("b8f9")},f97f:function(t,e,r){},fe92:function(t,e,r){}});
//# sourceMappingURL=app.62773c4b.js.map