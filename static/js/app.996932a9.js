(function(e){function t(t){for(var a,i,o=t[0],c=t[1],l=t[2],d=0,p=[];d<o.length;d++)i=o[d],Object.prototype.hasOwnProperty.call(n,i)&&n[i]&&p.push(n[i][0]),n[i]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(e[a]=c[a]);u&&u(t);while(p.length)p.shift()();return s.push.apply(s,l||[]),r()}function r(){for(var e,t=0;t<s.length;t++){for(var r=s[t],a=!0,o=1;o<r.length;o++){var c=r[o];0!==n[c]&&(a=!1)}a&&(s.splice(t--,1),e=i(i.s=r[0]))}return e}var a={},n={app:0},s=[];function i(t){if(a[t])return a[t].exports;var r=a[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=e,i.c=a,i.d=function(e,t,r){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)i.d(r,a,function(t){return e[t]}.bind(null,a));return r},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],c=o.push.bind(o);o.push=t,o=o.slice();for(var l=0;l<o.length;l++)t(o[l]);var u=c;s.push([0,"chunk-vendors"]),r()})({0:function(e,t,r){e.exports=r("56d7")},"036e":function(e,t,r){"use strict";r("932b")},1114:function(e,t,r){"use strict";r("97eb")},"149a":function(e,t,r){},1685:function(e,t,r){},"1a1c":function(e,t,r){},"3a60":function(e,t,r){},"3f33":function(e,t,r){"use strict";r("6471")},"46dd":function(e,t,r){},"52d6":function(e,t,r){},"56d7":function(e,t,r){"use strict";r.r(t);r("cadf"),r("551c"),r("f751"),r("097d");var a=r("ba4c"),n=r.n(a),s=r("660e");n.a.use(s["a"],{breakpoints:{mobile:450,tablet:900,laptop:1250,desktop:1/0}});var i=r("8c4f");n.a.use(i["a"]);var o=r("bb71");r("da64");n.a.use(o["a"],{theme:{primary:"#ea80fc",secondary:"#424242",accent:"#82B1FF",error:"#FF5252",info:"#2196F3",success:"#4CAF50",warning:"#FFC107"},iconfont:"md"});var c=r("b079"),l=r.n(c);r("4238");n.a.use(l.a,{position:"top"});var u=r("8cb8"),d=function(){var e=this,t=e._self._c;return t("div",{staticClass:"login-container"},[t("div",{staticClass:"login-form"},[t("h1",[e._v("INDOBENUA")]),e.loading?t("div",[t("i",{staticClass:"fa fa-spinner fa-spin"})]):t("form",{on:{submit:function(t){return t.preventDefault(),e.login.apply(null,arguments)}}},[t("div",{staticClass:"input-group"},[t("label",{attrs:{for:"username"}},[e._v("Username")]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.username,expression:"username"}],attrs:{type:"text",id:"username",required:"",autocomplete:"off"},domProps:{value:e.username},on:{input:function(t){t.target.composing||(e.username=t.target.value)}}}),e.errors.username?t("span",{staticClass:"error-message"},[e._v(e._s(e.errors.username[0]))]):e._e()]),t("div",{staticClass:"input-group"},[t("label",{attrs:{for:"password"}},[e._v("Password")]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.password,expression:"password"}],attrs:{type:"password",id:"password",required:"",autocomplete:"off"},domProps:{value:e.password},on:{input:function(t){t.target.composing||(e.password=t.target.value)}}}),e.errors.password?t("span",{staticClass:"error-message"},[e._v(e._s(e.errors.password[0]))]):e._e()]),t("button",{staticClass:"submit-button",attrs:{type:"submit"}},[e._v("Login")])]),e.errors.general?t("span",{staticClass:"error-message"},[e._v(e._s(e.errors.general))]):e._e()])])},p=[],f=(r("96cf"),r("1da1")),m=(r("7f7f"),r("faac")),v=r.n(m),g=(r("a481"),r("cee4")),h=(r("4917"),r("2f62"));n.a.use(h["a"]);var b=new h["a"].Store({state:{user:null,isLoading:!1,statistic:{},isWorker:!0},mutations:{setUser:function(e,t){e.user=t,e.isWorker=t.jabatan&&t.jabatan.name.match(/helper|teknisi|driver/i)},setLoading:function(e,t){e.isLoading=t},setStatistic:function(e,t){e.statistic=t}},actions:{fetchUser:function(e){return Object(f["a"])(regeneratorRuntime.mark((function t(){var r,a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=e.commit,t.prev=1,t.next=4,R.get("/user");case 4:a=t.sent,n=a.data,r("setUser",n),t.next=12;break;case 9:t.prev=9,t.t0=t["catch"](1),console.error("Failed to fetch user data:",t.t0);case 12:case"end":return t.stop()}}),t,null,[[1,9]])})))()},setLoading:function(e,t){var r=e.commit;r("setLoading",t)},setStatistic:function(e){return Object(f["a"])(regeneratorRuntime.mark((function t(){var r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=e.commit,t.prev=1,t.next=4,R.get("/statistic");case 4:a=t.sent,r("setStatistic",a.data),t.next=10;break;case 8:t.prev=8,t.t0=t["catch"](1);case 10:case"end":return t.stop()}}),t,null,[[1,8]])})))()}}}),w=(r("ac6a"),"myAppDB"),k=1,_="tasks",C="serviceCalls";function O(){return new Promise((function(e,t){var r=indexedDB.open(w,k);r.onupgradeneeded=function(e){var t=e.target.result;t.objectStoreNames.contains(_)||t.createObjectStore(_,{keyPath:"id"}),t.objectStoreNames.contains(C)||t.createObjectStore(C,{keyPath:"id"})},r.onsuccess=function(t){e(t.target.result)},r.onerror=function(e){t(e.target.error)}}))}function x(e,t){return O().then((function(r){return new Promise((function(a,n){var s=r.transaction([e],"readwrite"),i=s.objectStore(e);t.forEach((function(e){i.put(e)})),s.oncomplete=function(){a()},s.onerror=function(e){n(e.target.error)}}))}))}function y(e){return O().then((function(t){return new Promise((function(r,a){var n=t.transaction([e],"readonly"),s=n.objectStore(e),i=s.getAll();i.onsuccess=function(e){r(e.target.result)},i.onerror=function(e){a(e.target.error)}}))}))}function j(e){return O().then((function(t){return new Promise((function(r,a){var n=t.transaction([e],"readwrite"),s=n.objectStore(e),i=s.clear();i.onsuccess=function(){r()},i.onerror=function(e){a(e.target.error)}}))}))}function P(e,t,r,a){return D.apply(this,arguments)}function D(){return D=Object(f["a"])(regeneratorRuntime.mark((function e(t,r,a,n){var s,i,o,c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,O();case 2:return s=e.sent,i=s.transaction(t,"readwrite"),o=i.objectStore(t),c=o.get(r),c.onsuccess=function(){var e=c.result;if(e){switch(n){case"comments":e.task.comments=a;break;case"note":e.note=a;break;case"sc":e.status=a.status,e.lines=a.lines;break}o.put(e)}},e.abrupt("return",new Promise((function(e,t){i.oncomplete=e,i.onerror=t})));case 8:case"end":return e.stop()}}),e)}))),D.apply(this,arguments)}function S(){return new Promise((function(e,t){var r=indexedDB.deleteDatabase(w);r.onsuccess=function(){console.log("Database deleted successfully"),e()},r.onerror=function(e){console.error("Error deleting database:",e),t(e)},r.onblocked=function(){console.warn("Database deletion blocked"),t(new Error("Database deletion blocked"))}}))}var T=g["a"].create({baseURL:"https://ac.igm.biz.id/api",headers:{"Content-Type":"application/json"}});T.interceptors.request.use((function(e){var t=localStorage.getItem("api_token");return t&&(e.headers["Authorization"]="Bearer ".concat(t)),b.dispatch("setLoading",!0),e}),(function(e){return b.dispatch("setLoading",!1),Promise.reject(e)})),T.interceptors.response.use((function(e){return b.dispatch("setLoading",!1),e}),(function(e){if(e&&e.response&&e.response.status&&401===e.response.status){if("/test"===location.pathname)return void b.dispatch("setLoading",!1);console.log("User tidak autentik"),localStorage.clear(),S(),"/login"!==location.pathname&&location.replace("/login")}return b.dispatch("setLoading",!1),Promise.reject(e)}));var R=T,F={data:function(){return{username:"",password:"",deviceName:"",errors:{},loading:!1}},mounted:function(){this.deviceName=v.a.name+" "+v.a.version},methods:{login:function(){var e=this;return Object(f["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.errors={},e.loading=!0,t.prev=2,t.next=5,R.post("/login",{username:e.username,password:e.password,device_name:e.deviceName});case 5:r=t.sent,r.data&&r.data.token&&(localStorage.setItem("api_token",r.data.token),localStorage.setItem("user_id",r.data.user.id),e.$router.push("/")),t.next=12;break;case 9:t.prev=9,t.t0=t["catch"](2),t.t0.response&&422===t.t0.response.status?e.errors=t.t0.response.data.errors||{}:e.errors.general="Login failed. Please check your credentials and try again.";case 12:return t.prev=12,e.loading=!1,t.finish(12);case 15:case"end":return t.stop()}}),t,null,[[2,9,12,15]])})))()}}},I=F,L=(r("cc14"),r("0c7c")),M=Object(L["a"])(I,d,p,!1,null,"44503f32",null),E=M.exports,N=function(){var e=this,t=e._self._c;return e.user?t("div",{staticClass:"home-container"},[t("div",{staticClass:"welcome-message"},[e._v(" Welcome, "+e._s(e.user.surname)+" "+e._s(e.user.first_name)+" "+e._s(e.user.last_name)+" ")]),e.statistic.HtmlInfo?t("div",{domProps:{innerHTML:e._s(e.statistic.HtmlInfo)}}):e._e(),t("div",{staticClass:"button-container"},[t("button",{staticClass:"button check-in-button",on:{click:e.handleCheckLockIn}},[e._v("Check Lock In")]),t("button",{staticClass:"button check-out-button",on:{click:e.handleCheckLockOut}},[e._v("Check Lock Out")])]),t("div",{staticClass:"location-text"},[e._v(e._s(e.locationText))])]):e._e()},$=[],B=(r("8e6e"),r("456d"),r("ade3"));function U(e){return A.apply(this,arguments)}function A(){return A=Object(f["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!t||!t.showLoc){e.next=4;break}return e.next=3,V();case 3:return e.abrupt("return",e.sent);case 4:return e.abrupt("return",new Promise((function(e,t){navigator.geolocation?navigator.geolocation.getCurrentPosition(function(){var t=Object(f["a"])(regeneratorRuntime.mark((function t(r){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e({position:r});case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),(function(e){t(new Error("Geolocation error: ".concat(e.message)))})):t(new Error("Geolocation is not supported by this browser."))})));case 5:case"end":return e.stop()}}),e)}))),A.apply(this,arguments)}function V(){return z.apply(this,arguments)}function z(){return z=Object(f["a"])(regeneratorRuntime.mark((function e(){var t,r,a,n,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,U();case 3:return t=e.sent,r=t.position,a="https://nominatim.openstreetmap.org/reverse?format=jsonv2&lat=".concat(r.coords.latitude,"&lon=").concat(r.coords.longitude),e.next=8,R.get(a);case 8:if(n=e.sent,n.data){e.next=11;break}throw new Error("Indobenua");case 11:return s=n.data,e.abrupt("return",{position:r,loc:s});case 15:throw e.prev=15,e.t0=e["catch"](0),new Error("Failed to fetch location details: ".concat(e.t0.message));case 18:case"end":return e.stop()}}),e,null,[[0,15]])}))),z.apply(this,arguments)}function q(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function H(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?q(Object(r),!0).forEach((function(t){Object(B["a"])(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):q(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var G={data:function(){return{loading:!0,errorMsg:null,position:null,locationDetails:null,deviceName:""}},computed:H(H({},Object(h["c"])(["user","statistic"])),{},{locationText:function(){return this.errorMsg?this.errorMsg:this.locationDetails?this.locationDetails.display_name:"Waiting.."}}),methods:{fetchLocation:function(){var e=this;return Object(f["a"])(regeneratorRuntime.mark((function t(){var r,a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,U({showLoc:!0});case 3:r=t.sent,a=r.position,n=r.loc,e.position=a,e.locationDetails=n,t.next=14;break;case 10:t.prev=10,t.t0=t["catch"](0),console.error("Failed to fetch location:",t.t0),e.errorMsg=t.t0.message;case 14:case"end":return t.stop()}}),t,null,[[0,10]])})))()},handleCheckLockIn:function(){var e=this;return Object(f["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,R.post("/check-lock",{latitude:e.position.coords.latitude,longitude:e.position.coords.longitude,description:"Check Lock In",name:"check_clock_in"});case 3:alert("Success","Check Lock In successful"),t.next=10;break;case 6:t.prev=6,t.t0=t["catch"](0),n.a.$toast.error(t.t0.message),console.error(t.t0);case 10:case"end":return t.stop()}}),t,null,[[0,6]])})))()},handleCheckLockOut:function(){var e=this;return Object(f["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,R.post("/check-lock",{latitude:e.position.coords.latitude,longitude:e.position.coords.longitude,description:"Check Lock Out",name:"check_clock_out"});case 3:alert("Success","Check Lock Out successful"),t.next=10;break;case 6:t.prev=6,t.t0=t["catch"](0),n.a.$toast.error(t.t0.message),console.error(t.t0);case 10:case"end":return t.stop()}}),t,null,[[0,6]])})))()}},mounted:function(){this.deviceName=v.a.name+" "+v.a.version,this.fetchLocation(),setTimeout((function(){localStorage.getItem("api_token")&&!document.querySelector(".nav-tabs")&&location.reload()}),5e3)}},W=G,J=(r("6271"),Object(L["a"])(W,N,$,!1,null,"c5276c32",null)),K=J.exports,Y=function(){var e=this,t=e._self._c;return t("div",{staticClass:"task-container"},[t("div",{staticClass:"header-container"},[t("div",{staticClass:"filter-container"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.searchText,expression:"searchText"}],staticClass:"input",attrs:{type:"text",placeholder:"Search..."},domProps:{value:e.searchText},on:{input:function(t){t.target.composing||(e.searchText=t.target.value)}}}),t("button",{staticClass:"filter",on:{click:e.toggleDateFilterModal}},[e._v(" "+e._s(e.dateFilter)+" ")]),t("button",{staticClass:"filter",style:{backgroundColor:e.getStatusFilterColor()},on:{click:e.toggleStatusFilterModal}},[e._v(" "+e._s(e.statusFilter)+" ")])])]),e.loading?t("div",{staticClass:"loading-indicator"},[e._m(0)]):e.filteredTasks.length?t("div",{staticClass:"tasks-list"},e._l(e.filteredTasks,(function(r,a){return t("div",{key:a,staticClass:"task-item"},[t("router-link",{staticClass:"task-link",attrs:{to:{name:"DetailTask",params:{task:r,id:r.id}}}},[t("div",{staticClass:"item",style:{backgroundColor:e.getStatusFilterColor()}},[e.isWorker?e._e():t("div",{staticClass:"tech-name"},[e._v(" "+e._s(r.store.route&&r.store.route.teknisi&&r.store.route.teknisi.nickname)+" ")]),t("div",{staticClass:"avatar"},[t("span",{staticClass:"avatar-text"},[e._v(e._s(r.store.store_code))])]),t("div",{staticClass:"item-content"},[t("div",{staticClass:"title"},[e._v(e._s(r.store.route.index_route)+". "+e._s(r.store.store_name))]),t("div",{staticClass:"description"},[e._v(e._s(r.trx_no)+" Periode: "+e._s(r.periode))]),t("div",{staticClass:"reminder"},[e._v(" "+e._s(r.previous_month_projects.reduce((function(e,t){return(e?"":"REMINDER: ")+t.note}),"").substr(0,50))+" ")])]),t("div",{staticClass:"right-column"},[t("div",{staticClass:"req-date"},[e._v(e._s(e.formatDate(r.req_date)))])])])])],1)})),0):t("div",{staticClass:"empty-message"},[t("div",[e._v("No tasks available.")])]),e.isDateFilterModalVisible?t("div",{staticClass:"modal-backdrop"},[t("div",{staticClass:"modal-container"},[t("button",{on:{click:function(t){return e.selectDateFilter("Hari Ini")}}},[e._v("Hari Ini")]),t("button",{on:{click:function(t){return e.selectDateFilter("Minggu Ini")}}},[e._v("Minggu Ini")]),t("button",{on:{click:function(t){return e.selectDateFilter("Bulan Ini")}}},[e._v("Bulan Ini")])])]):e._e(),e.isStatusFilterModalVisible?t("div",{staticClass:"modal-backdrop"},[t("div",{staticClass:"modal-container"},[t("button",{on:{click:function(t){return e.selectStatusFilter("Pending")}}},[e._v("Pending")]),t("button",{on:{click:function(t){return e.selectStatusFilter("Review")}}},[e._v("Review")]),t("button",{on:{click:function(t){return e.selectStatusFilter("Lengkap")}}},[e._v("Lengkap")])])]):e._e()])},Z=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"loading-text"},[t("div",{staticClass:"fa fa-spinner"})])}];r("55dd"),r("6762"),r("2fdb");function Q(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function X(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Q(Object(r),!0).forEach((function(t){Object(B["a"])(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Q(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var ee={data:function(){return{loading:!1,tasks:[],searchText:"",dateFilter:"Hari Ini",statusFilter:"Pending",isDateFilterModalVisible:!1,isStatusFilterModalVisible:!1}},computed:X(X({},Object(h["c"])(["statistic","isWorker"])),{},{filteredTasks:function(){var e=this;return this.tasks.filter((function(t){return(t.store.store_name.toLowerCase().includes(e.searchText.toLowerCase())||t.task.subject.toLowerCase().includes(e.searchText.toLowerCase())||t.store.store_code.toLowerCase().includes(e.searchText.toLowerCase()))&&e.filterTasks(t)}))}}),methods:{fetchTasks:function(){var e=this;return Object(f["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.loading=!0,t.prev=1,t.next=4,R.get("/task");case 4:return r=t.sent,e.tasks=r.data,t.next=8,j("tasks");case 8:return t.next=10,x("tasks",e.tasks);case 10:e.statistic.tasks=e.tasks,t.next=16;break;case 13:t.prev=13,t.t0=t["catch"](1),console.error("Error fetching tasks:",t.t0);case 16:return t.prev=16,e.loading=!1,t.finish(16);case 19:case"end":return t.stop()}}),t,null,[[1,13,16,19]])})))()},filterTasks:function(e){var t=this,r=new Date,a=new Date(e.req_date),n=function(){if("Hari Ini"===t.dateFilter)return a.toDateString()===r.toDateString();if("Minggu Ini"===t.dateFilter){var e=new Date(r.setDate(r.getDate()-r.getDay())),n=new Date(r.setDate(r.getDate()-r.getDay()+6));return a>=e&&a<=n}if("Bulan Ini"===t.dateFilter){var s=new Date(r.getFullYear(),r.getMonth(),1),i=new Date(r.getFullYear(),r.getMonth()+1,0);return a>=s&&a<=i}return!0}(),s=function(){return"Lengkap"===t.statusFilter?"completed"===e.task.status:"Review"===t.statusFilter?"in_progress"===e.task.status&&e.task.comments&&e.task.comments.length>0:"Pending"!==t.statusFilter||"in_progress"===e.task.status&&(!e.task.comments||0===e.task.comments.length)}();return"Hari Ini"===this.dateFilter&&"Pending"===this.statusFilter?a<=r&&s:n&&s},toggleDateFilterModal:function(){this.isDateFilterModalVisible=!this.isDateFilterModalVisible},toggleStatusFilterModal:function(){this.isStatusFilterModalVisible=!this.isStatusFilterModalVisible},selectDateFilter:function(e){this.dateFilter=e,this.isDateFilterModalVisible=!1},selectStatusFilter:function(e){this.statusFilter=e,this.isStatusFilterModalVisible=!1},getStatusFilterColor:function(){switch(this.statusFilter){case"Pending":return"#fff3b0";case"Review":return"#b2f0f0";case"Lengkap":return"#d4f8d4";default:return"#fff"}},formatDate:function(e){var t=new Date(e);return t.toLocaleDateString("id-ID",{day:"2-digit",month:"2-digit"})},checkDataTasks:function(){var e=this;return Object(f["a"])(regeneratorRuntime.mark((function t(){var r,a,n,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.loading=!0,t.next=3,y("tasks");case 3:if(r=t.sent,a=localStorage.getItem("lastUpdate_tasks"),n=(new Date).getTime(),s=a&&n-a>144e5,r.length&&!s){t.next=13;break}return t.next=10,e.fetchTasks();case 10:localStorage.setItem("lastUpdate_tasks",n),t.next=14;break;case 13:e.tasks=r.sort((function(e,t){return e.store.route.index_route-t.store.route.index_route}));case 14:e.statistic.task_count=e.tasks.filter((function(e){return"in_progress"===e.task.status&&!e.task.comments.length&&new Date(e.req_date).getDate()<=(new Date).getDate()})).length,e.loading=!1;case 16:case"end":return t.stop()}}),t)})))()}},mounted:function(){var e=this;return Object(f["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.checkDataTasks();case 1:case"end":return t.stop()}}),t)})))()}},te=ee,re=(r("5746"),Object(L["a"])(te,Y,Z,!1,null,"ed7cdac2",null)),ae=re.exports,ne=function(){var e=this,t=e._self._c;return t("div",[t("div",{ref:"detailTaskContainer",staticClass:"detail-task-container"},[t("div",{staticClass:"header"},[t("router-link",{staticClass:"back-button",attrs:{to:"/task"}},[e._v("Back to Tasks")]),t("h1")],1),e.task?t("div",[t("div",{staticClass:"task-detail"},[t("h2",[e._v(e._s(e.task.store.store_name))]),t("p",[t("strong",[e._v("Kode Toko:")]),e._v(" "+e._s(e.task.store.store_code))]),t("p",[t("strong",[e._v("Rute:")]),e._v(" "+e._s(e.task.store.route.index_route))]),t("p",[t("strong",[e._v("Nomer Transaksi:")]),e._v(" "+e._s(e.task.trx_no))]),t("p",[t("strong",[e._v("Periode:")]),e._v(" "+e._s(e.task.periode))]),t("p",[t("strong",[e._v("Request Date:")]),e._v(" "+e._s(e.formatDate(e.task.req_date)))]),t("p",[t("strong",[e._v("Status:")]),e._v(" "+e._s(e.task.task.status))])]),t("div",{staticClass:"infoContainer"},[t("div",{staticClass:"infoBox"},[t("div",{staticClass:"infoTitle"},[e._v("Catatan bulan lalu:")]),t("div",{staticClass:"red-text"},[e._v(" "+e._s(e.task.previous_month_projects&&e.task.previous_month_projects.length?e.task.previous_month_projects.reduce((function(e,t){return e+t.note}),""):"")+" ")])]),t("div",{staticClass:"infoBox"},[t("div",{staticClass:"infoTitle"},[e._v("Tambahkan Catatan bulan ini:")]),t("Modal",{attrs:{isVisible:e.isModalVisible,task:e.task},on:{close:e.closeModal,success:e.handleSuccess}}),t("div",{staticClass:"red-text",on:{click:e.openModal}},[e.task.note?t("span",[e._v(" "+e._s(e.task.note)+"  "),t("i",{staticClass:"fas fa-edit"})]):t("span",{staticClass:"icon-plus danger",on:{click:e.openModal}},[t("i",{staticClass:"fas fa-plus-circle"})])])],1)]),t("hr"),t("div",[t("ul",{ref:"commentList",staticClass:"comment-list"},e._l(e.comments,(function(r,a){return t("li",{key:a},[t("div",{class:{"comment-content current-user-content":r.commented_by.id===e.currentUserId,"comment-content other-user-content":r.commented_by.id!==e.currentUserId}},[t("div",{staticClass:"comment-header"},[t("span",{staticClass:"commented-by"},[e._v(e._s(r.commented_by.nickname))]),t("span",{staticClass:"comment-time"},[e._v(e._s(r.created_at))])]),r.media&&r.media.length?t("div",{staticClass:"comment-images"},e._l(r.media,(function(e,r){return t("img",{key:r,staticClass:"comment-image",attrs:{src:e.display_url,alt:"Comment image "+r,title:e.display_name}})})),0):e._e(),e._v(" "+e._s(r.comment)+" ")])])})),0)])]):t("div",{staticClass:"loading-indicator"},[t("i",{staticClass:"fa fa-spinner fa-spin"})])]),e.previewImages.length?t("div",{staticClass:"preview-image-container"},e._l(e.previewImages,(function(r,a){return t("div",{key:a,staticClass:"preview-image-wrapper"},[t("img",{staticClass:"preview-image",attrs:{src:r.data,alt:r.name}}),t("div",{staticClass:"image-details"},[t("span",[e._v("Size: "+e._s(e.formatFileSize(r.size)))])]),t("span",{staticClass:"remove-image",on:{click:function(t){return e.removePreviewImage(a)}}},[e._v("×")])])})),0):e._e(),t("div",{staticClass:"input-form"},[t("textarea",{directives:[{name:"model",rawName:"v-model",value:e.additionalText,expression:"additionalText"}],staticClass:"text-input",attrs:{placeholder:"Tambahkan pesan..."},domProps:{value:e.additionalText},on:{input:function(t){t.target.composing||(e.additionalText=t.target.value)}}}),t("div",{staticClass:"icons"},[t("label",{staticClass:"file-upload-button",attrs:{for:"file-upload"}},[t("i",{staticClass:"fas fa-paperclip"}),t("input",{ref:"fileUpload",staticStyle:{display:"none"},attrs:{id:"file-upload",type:"file",multiple:"",accept:"image/*"},on:{change:e.handleFileUpload}})]),t("button",{staticClass:"send-button",on:{click:e.submitData}},[t("i",{staticClass:"fas fa-paper-plane"})])])]),e.isCompressing?t("div",{staticClass:"compressing-indicator"},[t("i",{staticClass:"fas fa-spinner fa-spin"}),e._v(" Mengompres gambar... ")]):e._e()])},se=[],ie=(r("34ef"),r("28a5"),r("f559"),r("2909")),oe=(r("5df3"),r("1c4c"),function(){var e=this,t=e._self._c;return e.isVisible?t("div",{staticClass:"modal-overlay",on:{click:function(t){return t.target!==t.currentTarget?null:e.closeModal.apply(null,arguments)}}},[t("div",{staticClass:"modal-content"},[t("span",{staticClass:"close",on:{click:e.closeModal}},[e._v("×")]),t("h2",{staticClass:"reminder-title"},[e._v("Add Reminder")]),t("form",{on:{submit:function(t){return t.preventDefault(),e.submitForm.apply(null,arguments)}}},[t("div",{staticClass:"form-group"},[e._m(0),t("textarea",{directives:[{name:"model",rawName:"v-model",value:e.reminderText,expression:"reminderText"}],attrs:{placeholder:"Tulis disini",id:"reminder",required:""},domProps:{value:e.reminderText},on:{input:function(t){t.target.composing||(e.reminderText=t.target.value)}}})]),t("button",{staticClass:"btn-submit-modal",attrs:{type:"submit"}},[e._v("Simpan!")])])])]):e._e()}),ce=[function(){var e=this,t=e._self._c;return t("label",{attrs:{for:"reminder"}},[t("small",[e._v("Untuk pengingat bulan depan:")])])}];function le(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function ue(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?le(Object(r),!0).forEach((function(t){Object(B["a"])(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):le(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var de={name:"Modal",props:["isVisible","task"],data:function(){return{reminderText:""}},methods:{closeModal:function(){this.$emit("close")},submitForm:function(){var e=this;return Object(f["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$axios.post("/reminder/"+e.task.id,{reminder_message:e.reminderText});case 3:r=t.sent,200===r.status&&(e.$emit("success",ue(ue({},r.data),{},{reminderText:e.reminderText})),e.closeModal()),t.next=10;break;case 7:t.prev=7,t.t0=t["catch"](0),console.error("Error submitting reminder:",t.t0);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})))()}},created:function(){this.reminderText=this.task.note}},pe=de,fe=(r("64a4"),Object(L["a"])(pe,oe,ce,!1,null,null,null)),me=fe.exports,ve={components:{Modal:me},data:function(){return{task:this.$route.params.task||null,additionalText:"",previewImages:[],isModalVisible:!1,currentUserId:JSON.parse(localStorage.getItem("user_id")||"1"),isCompressing:!1}},created:function(){var e=this;return Object(f["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.task){t.next=5;break}return r=e.$route.params.id,t.next=4,e.fetchTask(r);case 4:e.task=t.sent;case 5:e.comments=e.task.task.comments||[],setTimeout((function(){e.scrollToBottom()}),500);case 7:case"end":return t.stop()}}),t)})))()},methods:{fetchTask:function(e){var t=this;return Object(f["a"])(regeneratorRuntime.mark((function r(){var a;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return t.loading=!0,r.prev=1,r.next=4,R.get("/task/".concat(e));case 4:return a=r.sent,r.abrupt("return",a.data[0]);case 8:r.prev=8,r.t0=r["catch"](1),console.error("Error fetching service call:",r.t0),n.a.$toast.error("Error","Gagal memuat data service call.");case 12:return r.prev=12,t.loading=!1,r.finish(12);case 15:case"end":return r.stop()}}),r,null,[[1,8,12,15]])})))()},formatDate:function(e){var t=new Date(e);return t.toLocaleDateString("id-ID")},formatFileSize:function(e){var t=Math.floor(Math.log(e)/Math.log(1024));return 1*(e/Math.pow(1024,t)).toFixed(0)+" "+["B","kB","MB","GB","TB"][t]},handleFileUpload:function(e){var t=this,r=Array.from(e.target.files);this.isCompressing=!0,console.log("Starting compression..."),Promise.all(r.map((function(e){return t.readAndCompressImage(e)}))).then((function(e){var r;console.log("Compressed Images:",e),(r=t.previewImages).push.apply(r,Object(ie["a"])(e))})).finally((function(){t.isCompressing=!1}))},readAndCompressImage:function(e){var t=this;return new Promise((function(r,a){var s=new FileReader;e.type.startsWith("image/")?(s.onload=function(){var n=Object(f["a"])(regeneratorRuntime.mark((function n(s){var i;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,t.compressImage(s.target.result,e.name);case 3:i=n.sent,console.log("Compressed Image:",i),r(i),n.next=11;break;case 8:n.prev=8,n.t0=n["catch"](0),a(n.t0);case 11:case"end":return n.stop()}}),n,null,[[0,8]])})));return function(e){return n.apply(this,arguments)}}(),s.onerror=function(e){return a(e)},s.readAsDataURL(e)):n.a.$toast.error("Hanya file gambar yang diperbolehkan.")}))},compressImage:function(e,t){return Object(f["a"])(regeneratorRuntime.mark((function r(){var a;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return a=new Image,a.src=e,r.abrupt("return",new Promise((function(e,r){a.onload=function(){var n=document.createElement("canvas"),s=n.getContext("2d");n.width=a.width,n.height=a.height,s.drawImage(a,0,0);var i,o=.8;do{i=n.toDataURL("image/jpeg",o);for(var c=atob(i.split(",")[1]),l=new ArrayBuffer(c.length),u=new Uint8Array(l),d=0;d<c.length;d++)u[d]=c.charCodeAt(d);var p=new Blob([l],{type:"image/jpeg"});if(console.log("Blob size: ".concat(p.size,", quality: ").concat(o)),p.size<=204800)return void(p?e({name:t,data:i,file:p,filemtime:Date.now(),size:p.size}):r("Blob creation failed"));o-=.1}while(o>0);r("Failed to compress image below 200KB")},a.onerror=function(e){return r(e)}})));case 3:case"end":return r.stop()}}),r)})))()},removePreviewImage:function(e){this.previewImages.splice(e,1),this.$refs.fileUpload.value=null},submitData:function(){var e=this;return Object(f["a"])(regeneratorRuntime.mark((function t(){var r,a,s,i,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.additionalText.trim()){t.next=3;break}return n.a.$toast.error("Tambahkan pesan terlebih dahulu"),t.abrupt("return");case 3:return t.next=5,U();case 5:if(r=t.sent,a=r.position,a){t.next=10;break}return n.a.$toast.error("Aktifkan GPS!"),t.abrupt("return");case 10:return s=new FormData,s.append("alfa_id",e.task.id),s.append("task_id",e.task.task.id),s.append("comment",e.additionalText),s.append("latitude",a.coords.latitude),s.append("longitude",a.coords.longitude),e.previewImages.forEach((function(e){s.append("photos[]",e.file,e.name),s.append("filemtimes[]",e.filemtime)})),t.prev=17,t.next=20,R.post("/task",s,{headers:{"Content-Type":"multipart/form-data"}});case 20:if(i=t.sent,o=i.data,!o.success){t.next=29;break}return e.comments=o.data.comments,e.additionalText="",e.previewImages=[],e.scrollToBottom(),t.next=29,P("tasks",e.task.id,e.comments,"comments");case 29:t.next=34;break;case 31:t.prev=31,t.t0=t["catch"](17),console.error("Error submitting data:",t.t0);case 34:case"end":return t.stop()}}),t,null,[[17,31]])})))()},openModal:function(){this.isModalVisible=!0},closeModal:function(){this.isModalVisible=!1},handleSuccess:function(e){var t=this;return Object(f["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(!e.success){r.next=4;break}return t.task.note=e.reminderText,r.next=4,P("tasks",t.task.id,e.reminderText,"note");case 4:console.log("Reminder added successfully:",e);case 5:case"end":return r.stop()}}),r)})))()},scrollToBottom:function(){var e=this;this.$nextTick((function(){var t=e.$refs.detailTaskContainer;setTimeout((function(){t.scrollTop=t.scrollHeight}),200)}))}}},ge=ve,he=(r("3f33"),Object(L["a"])(ge,ne,se,!1,null,"65337a46",null)),be=he.exports,we=function(){var e=this,t=e._self._c;return t("div",{staticClass:"container"},[t("div",{staticClass:"filter-container"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.searchText,expression:"searchText"}],staticClass:"input",attrs:{placeholder:"Search..."},domProps:{value:e.searchText},on:{input:function(t){t.target.composing||(e.searchText=t.target.value)}}}),t("button",{staticClass:"filter",style:{backgroundColor:e.getStatusFilterColor()},on:{click:function(t){e.isStatusFilterModalVisible=!0}}},[e._v(" "+e._s(e.statusFilter)+" ")])]),e.loading?t("div",{staticClass:"loading-indicator"},[t("i",{staticClass:"fa fa-spinner fa-spin"})]):t("div",[e.filteredServiceCalls.length?t("ul",{staticClass:"service-call-list"},e._l(e.filteredServiceCalls,(function(r,a){return t("li",{key:a,staticClass:"service-call-item",style:{backgroundColor:e.getStatusFilterColor()},on:{click:function(t){return e.navigateToDetail(r)}}},[e.isWorker?e._e():t("div",{staticClass:"tech-name"},[e._v(" "+e._s(r.store.route&&r.store.route.teknisi&&r.store.route.teknisi.nickname)+" ")]),e._m(0,!0),t("div",{staticClass:"item-content"},[t("p",{staticClass:"title"},[e._v(e._s(r.store&&r.store.store_code)+" "+e._s(r.store&&r.store.store_name))]),t("p",{staticClass:"description"},[e._v(e._s(r.subject))])]),t("div",{staticClass:"right-column"},[t("p",{staticClass:"tgl"},[e._v(e._s(e.formatDate(r.trx_date)))])])])})),0):t("div",{staticClass:"centered-view"},[t("p",{staticClass:"centered-text"},[e._v("Tidak ada service call saat ini.")])])]),t("transition",{attrs:{name:"fade"}},[e.isStatusFilterModalVisible?t("div",{staticClass:"modal"},[t("div",{staticClass:"modal-backdrop",on:{click:function(t){e.isStatusFilterModalVisible=!1}}}),t("div",{staticClass:"modal-container"},[t("button",{staticClass:"pending",on:{click:function(t){return e.setStatusFilter("Pending")}}},[e._v("Pending")]),t("button",{staticClass:"progress",on:{click:function(t){return e.setStatusFilter("Progress")}}},[e._v("Progress")]),t("button",{staticClass:"solved",on:{click:function(t){return e.setStatusFilter("Solved")}}},[e._v("Solved")])])]):e._e()])],1)},ke=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"avatar"},[t("i",{staticClass:"fa fa-phone",attrs:{"aria-hidden":"true"}})])}];function _e(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function Ce(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?_e(Object(r),!0).forEach((function(t){Object(B["a"])(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_e(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Oe={data:function(){return{loading:!1,serviceCalls:[],searchText:"",statusFilter:"Pending",isStatusFilterModalVisible:!1}},computed:Ce(Ce({},Object(h["c"])(["statistic","isWorker"])),{},{filteredServiceCalls:function(){var e=this;return this.serviceCalls.filter((function(t){return(t.store&&t.store.store_name.toLowerCase().includes(e.searchText.toLowerCase())||t.store&&t.store.store_code.toLowerCase().includes(e.searchText.toLowerCase())||t.subject&&t.subject.toLowerCase().includes(e.searchText.toLowerCase()))&&e.filterServiceCalls(t)}))}}),methods:{fetchServiceCalls:function(){var e=this;return Object(f["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.loading=!0,t.prev=1,t.next=4,R.get("/service-call");case 4:return r=t.sent,e.serviceCalls=r.data,t.next=8,j("serviceCalls");case 8:return t.next=10,x("serviceCalls",e.serviceCalls);case 10:t.next=16;break;case 12:t.prev=12,t.t0=t["catch"](1),n.a.$toast.error("Error fetching service calls:"),console.log("Error fetching service calls:",t.t0);case 16:return t.prev=16,e.loading=!1,t.finish(16);case 19:case"end":return t.stop()}}),t,null,[[1,12,16,19]])})))()},filterServiceCalls:function(e){return"Pending"===this.statusFilter?"pending"===e.status:"Progress"===this.statusFilter?"in_progress"===e.status:"Solved"!==this.statusFilter||"solved"===e.status},getStatusFilterColor:function(){switch(this.statusFilter){case"Pending":return"#ffebcc";case"Progress":return"#52e5ed";case"Solved":return"#d4f8d4";default:return"#fff"}},setStatusFilter:function(e){this.statusFilter=e,this.isStatusFilterModalVisible=!1},formatDate:function(e){return e.replace(/(\d{4})-(\d{2})-(\d{2})/,"$3/$2")},navigateToDetail:function(e){this.$router.push({name:"DetailServiceCall",params:{serviceCall:e,id:e.id}})},checkDataSC:function(){var e=this;return Object(f["a"])(regeneratorRuntime.mark((function t(){var r,a,n,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,y("serviceCalls");case 2:if(r=t.sent,a=localStorage.getItem("lastUpdate_sc"),n=(new Date).getTime(),s=a&&n-a>144e5,r.length&&!s){t.next=12;break}return t.next=9,e.fetchServiceCalls();case 9:localStorage.setItem("lastUpdate_sc",n),t.next=13;break;case 12:e.serviceCalls=r;case 13:e.statistic.sc_count=e.serviceCalls.filter((function(e){return"pending"===e.status})).length;case 14:case"end":return t.stop()}}),t)})))()}},mounted:function(){this.checkDataSC()}},xe=Oe,ye=(r("1114"),Object(L["a"])(xe,we,ke,!1,null,"25d04370",null)),je=ye.exports,Pe=function(){var e=this,t=e._self._c;return e.serviceCall?t("div",{staticClass:"container"},[t("header",{staticClass:"header"},[t("h1",[e._v(e._s(e.serviceCall.store.store_code)+" "+e._s(e.serviceCall.store.store_name))])]),e.loading?t("div",{staticClass:"indicator"},[t("span",[e._v("Loading...")])]):t("div",[t("div",{staticClass:"content"},[t("div",{staticClass:"details"},[t("div",{staticClass:"detail-row"},[t("i",{staticClass:"fa fa-calendar"}),t("span",[e._v(e._s(e.formatDate(e.serviceCall.trx_date)))])]),t("div",{staticClass:"detail-row"},[t("i",{staticClass:"fa fa-info-circle"}),t("span",[e._v(e._s(e.serviceCall.status))])]),t("div",{staticClass:"detail-row"},[t("i",{staticClass:"fa fa-phone"}),t("span",[e._v(e._s(e.serviceCall.pic))])]),t("div",{staticClass:"detail-row"},[t("i",{staticClass:"fa fa-file-text"}),t("span",[e._v(e._s(e.serviceCall.subject))])]),t("div",{staticClass:"detail-row"},[t("i",{staticClass:"fa fa-bank"}),t("span",[e._v(e._s(e.serviceCall.store.address))])])]),e._l(e.lines,(function(r){return t("div",{key:r.id,staticClass:"line-container"},[t("h2",[e._v("Unit No: "+e._s(r.unit_no))]),t("h3",[e._v("Complain Details: "+e._s(r.complain_details))]),t("input",{directives:[{name:"model",rawName:"v-model",value:r.trouble_causer,expression:"line.trouble_causer"}],staticClass:"input",attrs:{placeholder:"Penyebab",required:""},domProps:{value:r.trouble_causer},on:{input:function(t){t.target.composing||e.$set(r,"trouble_causer",t.target.value)}}}),t("input",{directives:[{name:"model",rawName:"v-model",value:r.solution,expression:"line.solution"}],staticClass:"input",attrs:{placeholder:"Solusi",required:""},domProps:{value:r.solution},on:{input:function(t){t.target.composing||e.$set(r,"solution",t.target.value)}}}),t("div",{staticClass:"photo-container"},[t("button",{staticStyle:{"font-size":"x-large"},on:{click:function(t){return e.handleAddPhotos(r.id)}}},[t("i",{staticClass:"fa fa-camera"})]),e._l(r.photos,(function(e,r){return t("div",{key:r,staticClass:"photo-preview"},[e.document_name?t("img",{staticClass:"photo",attrs:{src:"https://ac.igm.biz.id/public/uploads/media/"+e.document_name}}):t("img",{staticClass:"photo",attrs:{src:e.uri}})])}))],2)])})),t("div",{staticClass:"button-container"},[t("button",{staticClass:"button cancel-button",on:{click:e.handleCancel}},[e._v("Batal")]),t("button",{staticClass:"button",on:{click:e.handleSave}},[e._v("Simpan")])])],2)])]):e._e()},De=[];function Se(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function Te(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Se(Object(r),!0).forEach((function(t){Object(B["a"])(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Se(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Re={data:function(){return{loading:!1,serviceCall:this.$route.params.serviceCall||null,lines:[]}},created:function(){var e=this;return Object(f["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.serviceCall){t.next=6;break}return r=e.$route.params.id,t.next=4,e.fetchServiceCall(r);case 4:t.next=7;break;case 6:e.initializeLines(e.serviceCall.lines);case 7:case"end":return t.stop()}}),t)})))()},methods:{fetchServiceCall:function(e){var t=this;return Object(f["a"])(regeneratorRuntime.mark((function r(){var a;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return t.loading=!0,r.prev=1,r.next=4,R.get("/service-call/".concat(e));case 4:a=r.sent,t.serviceCall=a.data,t.initializeLines(t.serviceCall.lines),r.next=13;break;case 9:r.prev=9,r.t0=r["catch"](1),console.error("Error fetching service call:",r.t0),n.a.$toast.error("Error","Gagal memuat data service call.");case 13:return r.prev=13,t.loading=!1,r.finish(13);case 16:case"end":return r.stop()}}),r,null,[[1,9,13,16]])})))()},initializeLines:function(e){this.lines=e.map((function(e){return Te({},e)}))},formatDate:function(e){var t={year:"numeric",month:"long",day:"numeric"};return new Date(e).toLocaleDateString(void 0,t)},handleInputChange:function(e,t,r){this.lines=this.lines.map((function(a){return a.id===e?Te(Te({},a),{},Object(B["a"])({},t,r)):a}))},handleAddPhotos:function(e){var t=this;return Object(f["a"])(regeneratorRuntime.mark((function r(){var a;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:a=document.createElement("input"),a.type="file",a.accept="image/*",a.multiple=!0,a.onchange=function(){var r=Object(f["a"])(regeneratorRuntime.mark((function r(a){var n,s,i,o;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:n=a.target.files,s=[],i=regeneratorRuntime.mark((function r(){var a,i,c;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return a=n[o],r.next=3,t.compressImage(a);case 3:i=r.sent,c=new FileReader,c.onload=function(r){s.push({uri:r.target.result,file:i}),s.length===n.length&&(t.lines=t.lines.map((function(t){return t.id===e?Te(Te({},t),{},{photos:[].concat(Object(ie["a"])(t.photos),s)}):t})))},c.readAsDataURL(i);case 7:case"end":return r.stop()}}),r)})),o=0;case 4:if(!(o<n.length)){r.next=9;break}return r.delegateYield(i(),"t0",6);case 6:o++,r.next=4;break;case 9:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}(),a.click();case 6:case"end":return r.stop()}}),r)})))()},compressImage:function(e){return Object(f["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=new FileReader,t.abrupt("return",new Promise((function(t,a){r.onload=function(r){var a=new Image;a.src=r.target.result,a.onload=function(){var r=document.createElement("canvas"),n=r.getContext("2d"),s=1920,i=1920,o=a.width,c=a.height;o>c?o>s&&(c*=s/o,o=s):c>i&&(o*=i/c,c=i),r.width=o,r.height=c,n.drawImage(a,0,0,o,c),r.toBlob((function(r){t(new File([r],e.name,{type:e.type}))}),e.type,.5)}},r.onerror=function(e){return a(e)},r.readAsDataURL(e)})));case 2:case"end":return t.stop()}}),t)})))()},handleSave:function(){var e=this;return Object(f["a"])(regeneratorRuntime.mark((function t(){var r,a,s,i,o,c,l;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.loading=!0,t.prev=1,r=new FormData,r.append("sc_id",e.serviceCall.id),t.next=6,U();case 6:if(a=t.sent,s=a.position,s){t.next=11;break}return n.a.$toast.error("Aktifkan GPS!"),t.abrupt("return");case 11:if(r.append("latitude",s.coords.latitude),r.append("longitude",s.coords.longitude),i=e.lines.filter((function(e){return e.photos.length})).length,i){t.next=16;break}return t.abrupt("return",n.a.$toast.error("Masukkan Photo!"));case 16:if(o=e.lines.filter((function(e){return!!e.solution})).length,o){t.next=19;break}return t.abrupt("return",n.a.$toast.error("Solusi tidak boleh kosong!"));case 19:return e.lines.forEach((function(e,t){var a,n;e.photos.forEach((function(e){e.file&&(r.append("lines[".concat(t,"][photos][]"),e.file),r.append("lines[".concat(t,"][filemtime][]"),e.file.lastModified))})),r.append("lines[".concat(t,"][solution]"),null!==(a=e.solution)&&void 0!==a?a:""),r.append("lines[".concat(t,"][trouble_causer]"),null!==(n=e.trouble_causer)&&void 0!==n?n:"")})),t.next=22,R.post("/service-call/update",r,{headers:{"Content-Type":"multipart/form-data"}});case 22:return c=t.sent,l=c.data,t.next=26,P("serviceCalls",e.serviceCall.id,l,"sc");case 26:n.a.$toast.success("Berhasil disimpan"),e.$router.push({name:"ServiceCall",params:{serviceCall:e.serviceCall}}),t.next=34;break;case 30:t.prev=30,t.t0=t["catch"](1),console.error("Error saving data:",t.t0),n.a.$toast.error("Error","Terjadi kesalahan saat menyimpan data");case 34:return t.prev=34,e.loading=!1,t.finish(34);case 37:case"end":return t.stop()}}),t,null,[[1,30,34,37]])})))()},handleCancel:function(){this.$router.push({name:"ServiceCall",params:{serviceCall:this.serviceCall}})}}},Fe=Re,Ie=(r("70d0"),Object(L["a"])(Fe,Pe,De,!1,null,"885af8cc",null)),Le=Ie.exports,Me=function(){var e=this,t=e._self._c;return t("div",{staticClass:"safe-area"},[t("router-link",{attrs:{to:{name:"EditProfile",params:{userData:e.userData}}}},[t("button",{staticClass:"edit-button"},[t("i",{staticClass:"fa fa-edit edit-btn"})])]),t("div",{staticClass:"profile-container"},[t("img",{staticClass:"profile-image",attrs:{src:e.userData&&e.userData.media?e.userData.media.display_url:"/assets/images/default_profile.png",alt:"Profile Image"}}),t("h1",{staticClass:"title"},[e._v("Profile")]),e.userData?t("div",{staticClass:"data-profile-container"},[t("div",{staticClass:"info-container"},[t("span",{staticClass:"label"},[e._v("Name:")]),t("span",{staticClass:"value"},[e._v(e._s(e.userData.surname)+" "+e._s(e.userData.first_name)+" "+e._s(e.userData.last_name))])]),t("div",{staticClass:"info-container"},[t("span",{staticClass:"label"},[e._v("Username:")]),t("span",{staticClass:"value"},[e._v(e._s(e.userData.username))])]),t("div",{staticClass:"info-container"},[t("span",{staticClass:"label"},[e._v("Email:")]),t("span",{staticClass:"value"},[e._v(e._s(e.userData.email))])]),t("div",{staticClass:"info-container"},[t("span",{staticClass:"label"},[e._v("Jabatan:")]),e.userData.jabatan?t("span",{staticClass:"value"},[e._v(e._s(e.userData.jabatan.name))]):e._e()]),e.documents&&e.documents.length?t("div",{staticClass:"documents-container"},e._l(e.documents,(function(r,a){return t("div",{key:a,staticClass:"info-container",on:{click:function(t){return e.openDocument(r)}}},[t("span",{staticClass:"document-label"},[e._v(e._s(r.description)+":")]),t("i",{staticClass:"fa fa-chevron-right"})])})),0):e._e(),t("div",{staticClass:"logout-button-container"},[t("button",{on:{click:e.handleLogout}},[e._v("Logout")])])]):e._e()]),e.showPdfViewer?t("div",{staticClass:"pdf-viewer-modal"},[t("button",{on:{click:e.closePdfViewer}},[e._v("Close")]),t("PDFViewer",{attrs:{source:e.pdfUrl,controls:["zoom"],settings:{defaultZoom:200}}})],1):e._e()],1)},Ee=[],Ne=r("73e9"),$e=r.n(Ne),Be={components:{PDFViewer:$e.a},setup:function(){var e=Object(a["ref"])(null),t=Object(a["ref"])([]),r=Object(a["ref"])(!1),n=Object(a["ref"])(null),s=Object(a["ref"])(!0),i=function(){var e=Object(f["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return s.value=!0,e.prev=1,e.next=4,R.post("/logout");case 4:localStorage.clear(),location.replace("/login"),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](1),console.error("Logout failed:",e.t0);case 11:return e.prev=11,s.value=!1,e.finish(11);case 14:case"end":return e.stop()}}),e,null,[[1,8,11,14]])})));return function(){return e.apply(this,arguments)}}(),o=function(){var t=Object(f["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,R.get("/user");case 3:r=t.sent,e.value=r.data,t.next=10;break;case 7:t.prev=7,t.t0=t["catch"](0),console.error("Error fetching user data:",t.t0);case 10:return t.prev=10,s.value=!1,t.finish(10);case 13:case"end":return t.stop()}}),t,null,[[0,7,10,13]])})));return function(){return t.apply(this,arguments)}}(),c=function(){var e=Object(f["a"])(regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,R.get("/documents");case 3:r=e.sent,t.value=r.data,e.next=10;break;case 7:e.prev=7,e.t0=e["catch"](0),console.error("Error fetching documents:",e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),l=function(e){n.value="https://ac.igm.biz.id/public/uploads/documents/".concat(e.name,"#toolbar=0&navpanes=0&scrollbar=1"),r.value=!0},u=function(){r.value=!1,n.value=null},d=function(e){var t=e.src,r=e.filename,a=document.createElement("a");a.href=t,a.download=r,document.body.appendChild(a),a.click(),document.body.removeChild(a),console.log(t,r)};return Object(a["onMounted"])((function(){o(),c()})),{userData:e,documents:t,loading:s,handleLogout:i,showPdfViewer:r,pdfUrl:n,openDocument:l,closePdfViewer:u,handleDownload:d}}},Ue=Be,Ae=(r("036e"),Object(L["a"])(Ue,Me,Ee,!1,null,"537950a9",null)),Ve=Ae.exports,ze=function(){var e=this,t=e._self._c;return t("div",{staticClass:"safe-area"},[t("div",{staticClass:"custom-header"}),t("div",{staticClass:"form-container"},[t("div",{staticClass:"image-container"},[t("img",{staticClass:"profile-image",attrs:{src:e.profilePhoto?e.profilePhoto.uri:e.userData&&e.userData.media?e.userData.media.display_url:"/assets/images/default_profile.png",alt:"Profile Image"}}),t("button",{staticClass:"edit-icon",on:{click:e.pickImage}},[t("i",{staticClass:"fa fa-edit"})]),t("input",{ref:"fileInput",staticStyle:{display:"none"},attrs:{type:"file",accept:"image/*"},on:{change:e.handleFileChange}})]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.surName,expression:"surName"}],staticClass:"input",attrs:{placeholder:"SurName"},domProps:{value:e.surName},on:{input:function(t){t.target.composing||(e.surName=t.target.value)}}}),t("input",{directives:[{name:"model",rawName:"v-model",value:e.firstName,expression:"firstName"}],staticClass:"input",attrs:{placeholder:"First Name"},domProps:{value:e.firstName},on:{input:function(t){t.target.composing||(e.firstName=t.target.value)}}}),t("input",{directives:[{name:"model",rawName:"v-model",value:e.lastName,expression:"lastName"}],staticClass:"input",attrs:{placeholder:"Last Name"},domProps:{value:e.lastName},on:{input:function(t){t.target.composing||(e.lastName=t.target.value)}}}),t("input",{directives:[{name:"model",rawName:"v-model",value:e.email,expression:"email"}],staticClass:"input",attrs:{placeholder:"Email"},domProps:{value:e.email},on:{input:function(t){t.target.composing||(e.email=t.target.value)}}}),t("input",{directives:[{name:"model",rawName:"v-model",value:e.currentPassword,expression:"currentPassword"}],staticClass:"input",attrs:{type:"password",placeholder:"Current Password"},domProps:{value:e.currentPassword},on:{input:function(t){t.target.composing||(e.currentPassword=t.target.value)}}}),t("input",{directives:[{name:"model",rawName:"v-model",value:e.password,expression:"password"}],staticClass:"input",attrs:{type:"password",placeholder:"Password"},domProps:{value:e.password},on:{input:function(t){t.target.composing||(e.password=t.target.value)}}}),t("input",{directives:[{name:"model",rawName:"v-model",value:e.confirmPassword,expression:"confirmPassword"}],staticClass:"input",attrs:{type:"password",placeholder:"Confirm Password"},domProps:{value:e.confirmPassword},on:{input:function(t){t.target.composing||(e.confirmPassword=t.target.value)}}}),t("button",{staticClass:"save-button",on:{click:e.handleSave}},[e._v("Simpan")])]),e.loading?t("div",{staticClass:"loading-overlay"},[t("i",{staticClass:"fa fa-spinner fa-spin"})]):e._e()])},qe=[],He={setup:function(){var e=Object(a["ref"])(null),t=Object(a["ref"])(e.surname||""),r=Object(a["ref"])(e.first_name||""),s=Object(a["ref"])(e.last_name||""),i=Object(a["ref"])(e.email||""),o=Object(a["ref"])(""),c=Object(a["ref"])(""),l=Object(a["ref"])(""),u=Object(a["ref"])(e.profile_photo||null),d=Object(a["ref"])(!1),p=Object(a["ref"])(null),m=function(){var e=Object(f["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:p.value.click();case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),v=function(e){var t=e.target.files[0];if(t){var r=new FileReader;r.onload=function(){u.value={uri:URL.createObjectURL(t),file:t}},r.readAsDataURL(t)}},g=function(){var e=Object(f["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:n.a.$toast.success("Password berhasil diubah"),localStorage.clear(),location.replace("/login");case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),h=function(){var e=Object(f["a"])(regeneratorRuntime.mark((function e(){var a,p;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(o.value===c.value){e.next=3;break}return n.a.$toast.error("Password tidak sama!"),e.abrupt("return");case 3:if(!o.value||l.value){e.next=6;break}return n.a.$toast.error("Passwords tidak boleh kosong!"),e.abrupt("return");case 6:return d.value=!0,e.prev=7,a=new FormData,a.append("surname",t.value),a.append("first_name",r.value),a.append("last_name",s.value),a.append("email",i.value),o.value&&(a.append("password",o.value),a.append("current_password",l.value)),u.value&&u.value.file&&a.append("profile_photo",u.value.file),e.next=17,R.post("/user",a,{headers:{"Content-Type":"multipart/form-data"}});case 17:if(p=e.sent,200!==p.status){e.next=28;break}if(!p.data.password_changed){e.next=22;break}return g(),e.abrupt("return");case 22:if(!p.data.error){e.next=25;break}return n.a.$toast.error(p.data.msg),e.abrupt("return");case 25:n.a.$toast.success("Profile berhasil diupdate"),e.next=29;break;case 28:n.a.$toast.error("Failed to update profile");case 29:e.next=35;break;case 31:e.prev=31,e.t0=e["catch"](7),console.error("Error updating profile:",e.t0),n.a.$toast.error("Failed to update profile");case 35:return e.prev=35,d.value=!1,e.finish(35);case 38:case"end":return e.stop()}}),e,null,[[7,31,35,38]])})));return function(){return e.apply(this,arguments)}}(),b=function(){var t=Object(f["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,R.get("/user");case 3:r=t.sent,e.value=r.data,t.next=10;break;case 7:t.prev=7,t.t0=t["catch"](0),console.error("Error fetching user data:",t.t0);case 10:return t.prev=10,d.value=!1,t.finish(10);case 13:case"end":return t.stop()}}),t,null,[[0,7,10,13]])})));return function(){return t.apply(this,arguments)}}();return Object(a["onMounted"])((function(){b()})),Object(a["watch"])(e,(function(e){e&&(t.value=e.surname||"",r.value=e.first_name||"",s.value=e.last_name||"",i.value=e.email||"",u.value=e.profile_photo||null)})),{userData:e,surName:t,firstName:r,lastName:s,email:i,password:o,confirmPassword:c,currentPassword:l,profilePhoto:u,loading:d,pickImage:m,handleFileChange:v,handleSave:h,fileInput:p}}},Ge=He,We=(r("a7df"),Object(L["a"])(Ge,ze,qe,!1,null,"1149248b",null)),Je=We.exports,Ke=function(){var e=this,t=e._self._c;return t("div",[e.previewImages.length?t("div",{staticClass:"preview-image-container"},e._l(e.previewImages,(function(r,a){return t("div",{key:a,staticClass:"preview-image-wrapper"},[t("img",{staticClass:"preview-image",attrs:{src:r.data,alt:r.name}}),t("div",{staticClass:"image-details"},[t("span",[e._v("Size: "+e._s(e.formatFileSize(r.size)))])]),t("span",{staticClass:"remove-image",on:{click:function(t){return e.removePreviewImage(a)}}},[e._v("×")])])})),0):e._e(),t("div",{staticClass:"input-form"},[t("textarea",{directives:[{name:"model",rawName:"v-model",value:e.additionalText,expression:"additionalText"}],staticClass:"text-input",attrs:{placeholder:"Tambahkan pesan..."},domProps:{value:e.additionalText},on:{input:function(t){t.target.composing||(e.additionalText=t.target.value)}}}),t("div",{staticClass:"icons"},[t("label",{staticClass:"file-upload-button",attrs:{for:"file-upload"}},[t("i",{staticClass:"fas fa-paperclip"}),t("input",{ref:"fileUpload",staticStyle:{display:"none"},attrs:{id:"file-upload",type:"file",multiple:"",accept:"image/*"},on:{change:e.handleFileUpload}})]),t("button",{staticClass:"send-button",on:{click:e.submitData}},[t("i",{staticClass:"fas fa-paper-plane"})])])]),e.isCompressing?t("div",{staticClass:"compressing-indicator"},[t("i",{staticClass:"fas fa-spinner fa-spin"}),e._v(" Mengompres gambar... ")]):e._e()])},Ye=[],Ze={data:function(){return{task:this.$route.params.task||null,additionalText:"",previewImages:[],isModalVisible:!1,currentUserId:JSON.parse(localStorage.getItem("user_id")||"1"),isCompressing:!1}},created:function(){var e=this;return Object(f["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.comments=e.task.task.comments||[],setTimeout((function(){e.scrollToBottom()}),500);case 2:case"end":return t.stop()}}),t)})))()},methods:{fetchTask:function(e){var t=this;return Object(f["a"])(regeneratorRuntime.mark((function r(){var a;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return t.loading=!0,r.prev=1,r.next=4,R.get("/task/".concat(e));case 4:return a=r.sent,r.abrupt("return",a.data[0]);case 8:r.prev=8,r.t0=r["catch"](1),console.error("Error fetching service call:",r.t0),n.a.$toast.error("Error","Gagal memuat data service call.");case 12:return r.prev=12,t.loading=!1,r.finish(12);case 15:case"end":return r.stop()}}),r,null,[[1,8,12,15]])})))()},formatDate:function(e){var t=new Date(e);return t.toLocaleDateString("id-ID")},formatFileSize:function(e){var t=Math.floor(Math.log(e)/Math.log(1024));return 1*(e/Math.pow(1024,t)).toFixed(0)+" "+["B","kB","MB","GB","TB"][t]},handleFileUpload:function(e){var t=this,r=Array.from(e.target.files);this.isCompressing=!0,console.log("Starting compression..."),Promise.all(r.map((function(e){return t.readAndCompressImage(e)}))).then((function(e){var r;console.log("Compressed Images:",e),(r=t.previewImages).push.apply(r,Object(ie["a"])(e))})).finally((function(){t.isCompressing=!1}))},readAndCompressImage:function(e){var t=this;return new Promise((function(r,a){var s=new FileReader;e.type.startsWith("image/")?(s.onload=function(){var n=Object(f["a"])(regeneratorRuntime.mark((function n(s){var i;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,t.compressImage(s.target.result,e.name);case 3:i=n.sent,console.log("Compressed Image:",i),r(i),n.next=11;break;case 8:n.prev=8,n.t0=n["catch"](0),a(n.t0);case 11:case"end":return n.stop()}}),n,null,[[0,8]])})));return function(e){return n.apply(this,arguments)}}(),s.onerror=function(e){return a(e)},s.readAsDataURL(e)):n.a.$toast.error("Hanya file gambar yang diperbolehkan.")}))},compressImage:function(e,t){return Object(f["a"])(regeneratorRuntime.mark((function r(){var a;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return a=new Image,a.src=e,r.abrupt("return",new Promise((function(e,r){a.onload=function(){var n=document.createElement("canvas"),s=n.getContext("2d");n.width=a.width,n.height=a.height,s.drawImage(a,0,0);var i,o=.8;do{i=n.toDataURL("image/jpeg",o);for(var c=atob(i.split(",")[1]),l=new ArrayBuffer(c.length),u=new Uint8Array(l),d=0;d<c.length;d++)u[d]=c.charCodeAt(d);var p=new Blob([l],{type:"image/jpeg"});if(console.log("Blob size: ".concat(p.size,", quality: ").concat(o)),p.size<=204800)return void(p?e({name:t,data:i,file:p,filemtime:Date.now(),size:p.size}):r("Blob creation failed"));o-=.1}while(o>0);r("Failed to compress image below 200KB")},a.onerror=function(e){return r(e)}})));case 3:case"end":return r.stop()}}),r)})))()},removePreviewImage:function(e){this.previewImages.splice(e,1),this.$refs.fileUpload.value=null},submitData:function(){var e=this;return Object(f["a"])(regeneratorRuntime.mark((function t(){var r,a,s,i,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.additionalText.trim()){t.next=3;break}return n.a.$toast.error("Tambahkan pesan terlebih dahulu"),t.abrupt("return");case 3:return t.next=5,U();case 5:if(r=t.sent,a=r.position,a){t.next=10;break}return n.a.$toast.error("Aktifkan GPS!"),t.abrupt("return");case 10:return s=new FormData,s.append("alfa_id",e.task.id),s.append("task_id",e.task.task.id),s.append("comment",e.additionalText),s.append("latitude",a.coords.latitude),s.append("longitude",a.coords.longitude),e.previewImages.forEach((function(e){s.append("photos[]",e.file,e.name),s.append("filemtimes[]",e.filemtime)})),t.prev=17,t.next=20,R.post("/task",s,{headers:{"Content-Type":"multipart/form-data"}});case 20:if(i=t.sent,o=i.data,!o.success){t.next=29;break}return e.comments=o.data.comments,e.additionalText="",e.previewImages=[],e.scrollToBottom(),t.next=29,P("tasks",e.task.id,e.comments,"comments");case 29:t.next=34;break;case 31:t.prev=31,t.t0=t["catch"](17),console.error("Error submitting data:",t.t0);case 34:case"end":return t.stop()}}),t,null,[[17,31]])})))()},openModal:function(){this.isModalVisible=!0},closeModal:function(){this.isModalVisible=!1},handleSuccess:function(e){var t=this;return Object(f["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(!e.success){r.next=4;break}return t.task.note=e.reminderText,r.next=4,P("tasks",t.task.id,e.reminderText,"note");case 4:console.log("Reminder added successfully:",e);case 5:case"end":return r.stop()}}),r)})))()},scrollToBottom:function(){var e=this;this.$nextTick((function(){var t=e.$refs.detailTaskContainer;setTimeout((function(){t.scrollTop=t.scrollHeight}),200)}))}}},Qe=Ze,Xe=(r("8601"),Object(L["a"])(Qe,Ke,Ye,!1,null,"0fba1e02",null)),et=Xe.exports,tt=[{path:"/",exact:!0,component:K,icon:"home",name:"Home",meta:{requiresAuth:!0}},{path:"/task",exact:!0,component:ae,icon:"psychology",name:"Task",meta:{requiresAuth:!0}},{path:"/task/:id",exact:!0,component:be,icon:"psychology",name:"DetailTask",meta:{requiresAuth:!0}},{path:"/service-call",exact:!0,component:je,icon:"psychology",name:"ServiceCall",meta:{requiresAuth:!0}},{path:"/service-call/:id",exact:!0,component:Le,icon:"psychology",name:"DetailServiceCall",meta:{requiresAuth:!0}},{path:"/profile",exact:!0,component:Ve,icon:"psychology",name:"Profile",meta:{requiresAuth:!0}},{path:"/edit-profile",exact:!0,component:Je,icon:"psychology",name:"EditProfile",meta:{requiresAuth:!0}},{path:"/login",exact:!0,component:E,icon:"question_answer",name:"Login"},{path:"/test",exact:!0,component:et,icon:"question_answer",name:"Test"},{path:"*",redirect:"/"}],rt=new i["a"]({routes:tt,mode:"history"});rt.beforeEach((function(e,t,r){var a=localStorage.getItem("api_token");e.matched.some((function(e){return e.meta.requiresAuth}))&&!a?r("/login"):r()}));var at=rt,nt=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"app"}},[t("Header"),t("NavTabs"),t("router-view"),t("Spinner")],1)},st=[],it=function(){var e=this,t=e._self._c;return e.isLoggedIn?t("header",{staticClass:"header"},[e._m(0),t("div",{staticClass:"date"},[e._v(" "+e._s(e.currentDate)+" ")])]):e._e()},ot=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"logo"},[t("span",{staticClass:"logo-text"},[e._v("INDOBENUA")])])}];function ct(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function lt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ct(Object(r),!0).forEach((function(t){Object(B["a"])(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ct(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var ut={name:"Header",computed:lt({},Object(h["c"])({isLoggedIn:function(e){return!!e.user}})),data:function(){return{currentDate:""}},mounted:function(){this.updateCurrentDate()},methods:{updateCurrentDate:function(){var e=new Date,t={weekday:"long",year:"numeric",month:"long",day:"numeric"};this.currentDate=e.toLocaleDateString("id-ID",t)}}},dt=ut,pt=(r("88cc"),Object(L["a"])(dt,it,ot,!1,null,"7602e895",null)),ft=pt.exports,mt=function(){var e=this,t=e._self._c;return e.isLoggedIn?t("nav",{staticClass:"nav-tabs"},[t("router-link",{staticClass:"nav-link",attrs:{to:"/"}},[e._v("Home")]),t("router-link",{staticClass:"nav-link",attrs:{to:"/task"}},[e._v(" Task "),e.statistics.task_count?t("span",{staticClass:"badge"},[e._v(e._s(e.statistics.task_count))]):e._e()]),t("router-link",{staticClass:"nav-link",attrs:{to:"/service-call"}},[e._v(" Complain "),e.statistics.sc_count?t("span",{staticClass:"badge"},[e._v(e._s(e.statistics.sc_count))]):e._e()]),t("router-link",{staticClass:"nav-link",attrs:{to:"/profile"}},[e._v("Profile")])],1):e._e()},vt=[];function gt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function ht(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?gt(Object(r),!0).forEach((function(t){Object(B["a"])(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):gt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var bt={name:"NavTabs",computed:ht({},Object(h["c"])({isLoggedIn:function(e){return!!e.user},statistics:function(e){return e.statistic}}))},wt=bt,kt=(r("e29d"),Object(L["a"])(wt,mt,vt,!1,null,"212b13cf",null)),_t=kt.exports,Ct=function(){var e=this,t=e._self._c;return e.isLoading?t("div",{staticClass:"spinner-overlay"},[t("div",{staticClass:"spinner"})]):e._e()},Ot=[];function xt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function yt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?xt(Object(r),!0).forEach((function(t){Object(B["a"])(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):xt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var jt={computed:yt({},Object(h["c"])({isLoading:function(e){return e.isLoading}}))},Pt=jt,Dt=(r("f364"),Object(L["a"])(Pt,Ct,Ot,!1,null,"3ac66530",null)),St=Dt.exports;function Tt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function Rt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Tt(Object(r),!0).forEach((function(t){Object(B["a"])(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Tt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Ft={name:"App",components:{Header:ft,NavTabs:_t,Spinner:St},created:function(){this.fetchUser(),this.setStatistic()},methods:Rt({},Object(h["b"])(["fetchUser","setStatistic"]))},It=Ft,Lt=(r("a9a5"),Object(L["a"])(It,nt,st,!1,null,null,null)),Mt=Lt.exports;n.a.use(u["default"]),n.a.config.productionTip=!1,n.a.prototype.$axios=R,new n.a({store:b,router:at,render:function(e){return e(Mt)}}).$mount("#app")},5746:function(e,t,r){"use strict";r("def0")},6271:function(e,t,r){"use strict";r("149a")},6471:function(e,t,r){},"64a4":function(e,t,r){"use strict";r("c667")},"6feb":function(e,t,r){},"70d0":function(e,t,r){"use strict";r("1a1c")},8601:function(e,t,r){"use strict";r("52d6")},"88cc":function(e,t,r){"use strict";r("d73a")},"932b":function(e,t,r){},"97eb":function(e,t,r){},a7df:function(e,t,r){"use strict";r("1685")},a9a5:function(e,t,r){"use strict";r("6feb")},c667:function(e,t,r){},cc14:function(e,t,r){"use strict";r("d0ab")},d0ab:function(e,t,r){},d73a:function(e,t,r){},def0:function(e,t,r){},e29d:function(e,t,r){"use strict";r("46dd")},f364:function(e,t,r){"use strict";r("3a60")}});
//# sourceMappingURL=app.996932a9.js.map